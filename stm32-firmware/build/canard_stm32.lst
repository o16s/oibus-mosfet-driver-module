ARM GAS  /tmp/ccGBICaP.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"canard_stm32.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.isFramePriorityHigher,"ax",%progbits
  18              		.align	1
  19              		.arch armv7e-m
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv4-sp-d16
  25              	isFramePriorityHigher:
  26              	.LVL0:
  27              	.LFB1:
  28              		.file 1 "Lib/libcanard/drivers/stm32/canard_stm32.c"
   1:Lib/libcanard/drivers/stm32/canard_stm32.c **** /*
   2:Lib/libcanard/drivers/stm32/canard_stm32.c ****  * Copyright (c) 2017 UAVCAN Team
   3:Lib/libcanard/drivers/stm32/canard_stm32.c ****  *
   4:Lib/libcanard/drivers/stm32/canard_stm32.c ****  * Distributed under the MIT License, available in the file LICENSE.
   5:Lib/libcanard/drivers/stm32/canard_stm32.c ****  *
   6:Lib/libcanard/drivers/stm32/canard_stm32.c ****  * Author: Pavel Kirienko <pavel.kirienko@zubax.com>
   7:Lib/libcanard/drivers/stm32/canard_stm32.c ****  */
   8:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
   9:Lib/libcanard/drivers/stm32/canard_stm32.c **** #include "canard_stm32.h"
  10:Lib/libcanard/drivers/stm32/canard_stm32.c **** #include "_internal_bxcan.h"
  11:Lib/libcanard/drivers/stm32/canard_stm32.c **** #include <unistd.h>
  12:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
  13:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
  14:Lib/libcanard/drivers/stm32/canard_stm32.c **** #if CANARD_STM32_USE_CAN2
  15:Lib/libcanard/drivers/stm32/canard_stm32.c **** # define BXCAN                                                  CANARD_STM32_CAN2
  16:Lib/libcanard/drivers/stm32/canard_stm32.c **** #else
  17:Lib/libcanard/drivers/stm32/canard_stm32.c **** # define BXCAN                                                  CANARD_STM32_CAN1
  18:Lib/libcanard/drivers/stm32/canard_stm32.c **** #endif
  19:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
  20:Lib/libcanard/drivers/stm32/canard_stm32.c **** /*
  21:Lib/libcanard/drivers/stm32/canard_stm32.c ****  * State variables
  22:Lib/libcanard/drivers/stm32/canard_stm32.c ****  */
  23:Lib/libcanard/drivers/stm32/canard_stm32.c **** static CanardSTM32Stats g_stats;
  24:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
  25:Lib/libcanard/drivers/stm32/canard_stm32.c **** static bool g_abort_tx_on_error = false;
  26:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
  27:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
  28:Lib/libcanard/drivers/stm32/canard_stm32.c **** static bool isFramePriorityHigher(uint32_t a, uint32_t b)
  29:Lib/libcanard/drivers/stm32/canard_stm32.c **** {
  29              		.loc 1 29 1 view -0
ARM GAS  /tmp/ccGBICaP.s 			page 2


  30              		.cfi_startproc
  31              		@ args = 0, pretend = 0, frame = 0
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33              		@ link register save eliminated.
  34              		.loc 1 29 1 is_stmt 0 view .LVU1
  35 0000 10B4     		push	{r4}
  36              	.LCFI0:
  37              		.cfi_def_cfa_offset 4
  38              		.cfi_offset 4, -4
  39 0002 0346     		mov	r3, r0
  30:Lib/libcanard/drivers/stm32/canard_stm32.c ****     const uint32_t clean_a = a & CANARD_CAN_EXT_ID_MASK;
  40              		.loc 1 30 5 is_stmt 1 view .LVU2
  41              		.loc 1 30 20 is_stmt 0 view .LVU3
  42 0004 20F06044 		bic	r4, r0, #-536870912
  43              	.LVL1:
  31:Lib/libcanard/drivers/stm32/canard_stm32.c ****     const uint32_t clean_b = b & CANARD_CAN_EXT_ID_MASK;
  44              		.loc 1 31 5 is_stmt 1 view .LVU4
  45              		.loc 1 31 20 is_stmt 0 view .LVU5
  46 0008 21F06042 		bic	r2, r1, #-536870912
  47              	.LVL2:
  32:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
  33:Lib/libcanard/drivers/stm32/canard_stm32.c ****     /*
  34:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * STD vs EXT - if 11 most significant bits are the same, EXT loses.
  35:Lib/libcanard/drivers/stm32/canard_stm32.c ****      */
  36:Lib/libcanard/drivers/stm32/canard_stm32.c ****     const bool ext_a = (a & CANARD_CAN_FRAME_EFF) != 0;
  48              		.loc 1 36 5 is_stmt 1 view .LVU6
  37:Lib/libcanard/drivers/stm32/canard_stm32.c ****     const bool ext_b = (b & CANARD_CAN_FRAME_EFF) != 0;
  49              		.loc 1 37 5 view .LVU7
  50              		.loc 1 37 16 is_stmt 0 view .LVU8
  51 000c C80F     		lsrs	r0, r1, #31
  52              	.LVL3:
  38:Lib/libcanard/drivers/stm32/canard_stm32.c ****     if (ext_a != ext_b)
  53              		.loc 1 38 5 is_stmt 1 view .LVU9
  54              		.loc 1 38 8 is_stmt 0 view .LVU10
  55 000e B0EBD37F 		cmp	r0, r3, lsr #31
  56 0012 10D0     		beq	.L2
  57              	.LBB2:
  39:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
  40:Lib/libcanard/drivers/stm32/canard_stm32.c ****         const uint32_t arb11_a = ext_a ? (clean_a >> 18U) : clean_a;
  58              		.loc 1 40 9 is_stmt 1 view .LVU11
  59              		.loc 1 40 59 is_stmt 0 view .LVU12
  60 0014 002B     		cmp	r3, #0
  61 0016 0ADB     		blt	.L8
  62              	.LVL4:
  63              	.L3:
  41:Lib/libcanard/drivers/stm32/canard_stm32.c ****         const uint32_t arb11_b = ext_b ? (clean_b >> 18U) : clean_b;
  64              		.loc 1 41 9 is_stmt 1 discriminator 4 view .LVU13
  65              		.loc 1 41 59 is_stmt 0 discriminator 4 view .LVU14
  66 0018 0029     		cmp	r1, #0
  67 001a 0ADB     		blt	.L9
  68              	.LVL5:
  69              	.L4:
  42:Lib/libcanard/drivers/stm32/canard_stm32.c ****         if (arb11_a != arb11_b)
  70              		.loc 1 42 9 is_stmt 1 discriminator 4 view .LVU15
  71              		.loc 1 42 12 is_stmt 0 discriminator 4 view .LVU16
  72 001c 9442     		cmp	r4, r2
  73 001e 03D0     		beq	.L5
ARM GAS  /tmp/ccGBICaP.s 			page 3


  43:Lib/libcanard/drivers/stm32/canard_stm32.c ****         {
  44:Lib/libcanard/drivers/stm32/canard_stm32.c ****             return arb11_a < arb11_b;
  74              		.loc 1 44 13 is_stmt 1 view .LVU17
  75              		.loc 1 44 28 is_stmt 0 view .LVU18
  76 0020 9442     		cmp	r4, r2
  77 0022 2CBF     		ite	cs
  78 0024 0020     		movcs	r0, #0
  79              	.LVL6:
  80              		.loc 1 44 28 view .LVU19
  81 0026 0120     		movcc	r0, #1
  82              	.LVL7:
  83              	.L5:
  84              		.loc 1 44 28 view .LVU20
  85              	.LBE2:
  45:Lib/libcanard/drivers/stm32/canard_stm32.c ****         }
  46:Lib/libcanard/drivers/stm32/canard_stm32.c ****         else
  47:Lib/libcanard/drivers/stm32/canard_stm32.c ****         {
  48:Lib/libcanard/drivers/stm32/canard_stm32.c ****             return ext_b;
  49:Lib/libcanard/drivers/stm32/canard_stm32.c ****         }
  50:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
  51:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
  52:Lib/libcanard/drivers/stm32/canard_stm32.c ****     /*
  53:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * RTR vs Data frame - if frame identifiers and frame types are the same, RTR loses.
  54:Lib/libcanard/drivers/stm32/canard_stm32.c ****      */
  55:Lib/libcanard/drivers/stm32/canard_stm32.c ****     const bool rtr_a = (a & CANARD_CAN_FRAME_RTR) != 0;
  56:Lib/libcanard/drivers/stm32/canard_stm32.c ****     const bool rtr_b = (b & CANARD_CAN_FRAME_RTR) != 0;
  57:Lib/libcanard/drivers/stm32/canard_stm32.c ****     if ((clean_a == clean_b) && (rtr_a != rtr_b))
  58:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
  59:Lib/libcanard/drivers/stm32/canard_stm32.c ****         return rtr_b;
  60:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
  61:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
  62:Lib/libcanard/drivers/stm32/canard_stm32.c ****     /*
  63:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * Plain ID arbitration - greater value loses.
  64:Lib/libcanard/drivers/stm32/canard_stm32.c ****      */
  65:Lib/libcanard/drivers/stm32/canard_stm32.c ****     return clean_a < clean_b;
  66:Lib/libcanard/drivers/stm32/canard_stm32.c **** }
  86              		.loc 1 66 1 view .LVU21
  87 0028 5DF8044B 		ldr	r4, [sp], #4
  88              	.LCFI1:
  89              		.cfi_remember_state
  90              		.cfi_restore 4
  91              		.cfi_def_cfa_offset 0
  92 002c 7047     		bx	lr
  93              	.LVL8:
  94              	.L8:
  95              	.LCFI2:
  96              		.cfi_restore_state
  97              	.LBB3:
  40:Lib/libcanard/drivers/stm32/canard_stm32.c ****         const uint32_t arb11_b = ext_b ? (clean_b >> 18U) : clean_b;
  98              		.loc 1 40 59 discriminator 1 view .LVU22
  99 002e A40C     		lsrs	r4, r4, #18
 100              	.LVL9:
  40:Lib/libcanard/drivers/stm32/canard_stm32.c ****         const uint32_t arb11_b = ext_b ? (clean_b >> 18U) : clean_b;
 101              		.loc 1 40 59 discriminator 1 view .LVU23
 102 0030 F2E7     		b	.L3
 103              	.LVL10:
 104              	.L9:
ARM GAS  /tmp/ccGBICaP.s 			page 4


  41:Lib/libcanard/drivers/stm32/canard_stm32.c ****         if (arb11_a != arb11_b)
 105              		.loc 1 41 59 discriminator 1 view .LVU24
 106 0032 920C     		lsrs	r2, r2, #18
 107              	.LVL11:
  41:Lib/libcanard/drivers/stm32/canard_stm32.c ****         if (arb11_a != arb11_b)
 108              		.loc 1 41 59 discriminator 1 view .LVU25
 109 0034 F2E7     		b	.L4
 110              	.LVL12:
 111              	.L2:
  41:Lib/libcanard/drivers/stm32/canard_stm32.c ****         if (arb11_a != arb11_b)
 112              		.loc 1 41 59 discriminator 1 view .LVU26
 113              	.LBE3:
  55:Lib/libcanard/drivers/stm32/canard_stm32.c ****     const bool rtr_b = (b & CANARD_CAN_FRAME_RTR) != 0;
 114              		.loc 1 55 5 is_stmt 1 view .LVU27
  55:Lib/libcanard/drivers/stm32/canard_stm32.c ****     const bool rtr_b = (b & CANARD_CAN_FRAME_RTR) != 0;
 115              		.loc 1 55 16 is_stmt 0 view .LVU28
 116 0036 C3F38073 		ubfx	r3, r3, #30, #1
 117              	.LVL13:
  56:Lib/libcanard/drivers/stm32/canard_stm32.c ****     if ((clean_a == clean_b) && (rtr_a != rtr_b))
 118              		.loc 1 56 5 is_stmt 1 view .LVU29
  56:Lib/libcanard/drivers/stm32/canard_stm32.c ****     if ((clean_a == clean_b) && (rtr_a != rtr_b))
 119              		.loc 1 56 16 is_stmt 0 view .LVU30
 120 003a C1F38070 		ubfx	r0, r1, #30, #1
 121              	.LVL14:
  57:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 122              		.loc 1 57 5 is_stmt 1 view .LVU31
  57:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 123              		.loc 1 57 8 is_stmt 0 view .LVU32
 124 003e 9442     		cmp	r4, r2
 125 0040 04D0     		beq	.L10
 126              	.L6:
  65:Lib/libcanard/drivers/stm32/canard_stm32.c **** }
 127              		.loc 1 65 5 is_stmt 1 view .LVU33
  65:Lib/libcanard/drivers/stm32/canard_stm32.c **** }
 128              		.loc 1 65 20 is_stmt 0 view .LVU34
 129 0042 9442     		cmp	r4, r2
 130 0044 2CBF     		ite	cs
 131 0046 0020     		movcs	r0, #0
 132              	.LVL15:
  65:Lib/libcanard/drivers/stm32/canard_stm32.c **** }
 133              		.loc 1 65 20 view .LVU35
 134 0048 0120     		movcc	r0, #1
 135 004a EDE7     		b	.L5
 136              	.LVL16:
 137              	.L10:
  57:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 138              		.loc 1 57 30 discriminator 1 view .LVU36
 139 004c 8342     		cmp	r3, r0
 140 004e EBD1     		bne	.L5
 141 0050 F7E7     		b	.L6
 142              		.cfi_endproc
 143              	.LFE1:
 145              		.section	.text.convertFrameIDCanardToRegister,"ax",%progbits
 146              		.align	1
 147              		.syntax unified
 148              		.thumb
 149              		.thumb_func
ARM GAS  /tmp/ccGBICaP.s 			page 5


 150              		.fpu fpv4-sp-d16
 152              	convertFrameIDCanardToRegister:
 153              	.LVL17:
 154              	.LFB2:
  67:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
  68:Lib/libcanard/drivers/stm32/canard_stm32.c **** /// Converts libcanard ID value into the bxCAN TX ID register format.
  69:Lib/libcanard/drivers/stm32/canard_stm32.c **** static uint32_t convertFrameIDCanardToRegister(const uint32_t id)
  70:Lib/libcanard/drivers/stm32/canard_stm32.c **** {
 155              		.loc 1 70 1 is_stmt 1 view -0
 156              		.cfi_startproc
 157              		@ args = 0, pretend = 0, frame = 0
 158              		@ frame_needed = 0, uses_anonymous_args = 0
 159              		@ link register save eliminated.
  71:Lib/libcanard/drivers/stm32/canard_stm32.c ****     uint32_t out = 0;
 160              		.loc 1 71 5 view .LVU38
  72:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
  73:Lib/libcanard/drivers/stm32/canard_stm32.c ****     if (id & CANARD_CAN_FRAME_EFF)
 161              		.loc 1 73 5 view .LVU39
 162              		.loc 1 73 8 is_stmt 0 view .LVU40
 163 0000 021E     		subs	r2, r0, #0
 164 0002 06DB     		blt	.L15
  74:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
  75:Lib/libcanard/drivers/stm32/canard_stm32.c ****         out = ((id & CANARD_CAN_EXT_ID_MASK) << 3U) | CANARD_STM32_CAN_TIR_IDE;
  76:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
  77:Lib/libcanard/drivers/stm32/canard_stm32.c ****     else
  78:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
  79:Lib/libcanard/drivers/stm32/canard_stm32.c ****         out = ((id & CANARD_CAN_STD_ID_MASK) << 21U);
 165              		.loc 1 79 9 is_stmt 1 view .LVU41
 166              		.loc 1 79 13 is_stmt 0 view .LVU42
 167 0004 5005     		lsls	r0, r2, #21
 168              	.LVL18:
 169              	.L13:
  80:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
  81:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
  82:Lib/libcanard/drivers/stm32/canard_stm32.c ****     if (id & CANARD_CAN_FRAME_RTR)
 170              		.loc 1 82 5 is_stmt 1 view .LVU43
 171              		.loc 1 82 8 is_stmt 0 view .LVU44
 172 0006 12F0804F 		tst	r2, #1073741824
 173 000a 01D0     		beq	.L11
  83:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
  84:Lib/libcanard/drivers/stm32/canard_stm32.c ****         out |= CANARD_STM32_CAN_TIR_RTR;
 174              		.loc 1 84 9 is_stmt 1 view .LVU45
 175              		.loc 1 84 13 is_stmt 0 view .LVU46
 176 000c 40F00200 		orr	r0, r0, #2
 177              	.LVL19:
  85:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
  86:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
  87:Lib/libcanard/drivers/stm32/canard_stm32.c ****     return out;
 178              		.loc 1 87 5 is_stmt 1 view .LVU47
 179              	.L11:
  88:Lib/libcanard/drivers/stm32/canard_stm32.c **** }
 180              		.loc 1 88 1 is_stmt 0 view .LVU48
 181 0010 7047     		bx	lr
 182              	.LVL20:
 183              	.L15:
  75:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 184              		.loc 1 75 9 is_stmt 1 view .LVU49
ARM GAS  /tmp/ccGBICaP.s 			page 6


  75:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 185              		.loc 1 75 46 is_stmt 0 view .LVU50
 186 0012 D300     		lsls	r3, r2, #3
  75:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 187              		.loc 1 75 13 view .LVU51
 188 0014 43F00400 		orr	r0, r3, #4
 189              	.LVL21:
  75:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 190              		.loc 1 75 13 view .LVU52
 191 0018 F5E7     		b	.L13
 192              		.cfi_endproc
 193              	.LFE2:
 195              		.section	.text.convertFrameIDRegisterToCanard,"ax",%progbits
 196              		.align	1
 197              		.syntax unified
 198              		.thumb
 199              		.thumb_func
 200              		.fpu fpv4-sp-d16
 202              	convertFrameIDRegisterToCanard:
 203              	.LVL22:
 204              	.LFB3:
  89:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
  90:Lib/libcanard/drivers/stm32/canard_stm32.c **** /// Converts bxCAN TX/RX (sic! both RX/TX are supported) ID register value into the libcanard ID fo
  91:Lib/libcanard/drivers/stm32/canard_stm32.c **** static uint32_t convertFrameIDRegisterToCanard(const uint32_t id)
  92:Lib/libcanard/drivers/stm32/canard_stm32.c **** {
 205              		.loc 1 92 1 is_stmt 1 view -0
 206              		.cfi_startproc
 207              		@ args = 0, pretend = 0, frame = 0
 208              		@ frame_needed = 0, uses_anonymous_args = 0
 209              		@ link register save eliminated.
  93:Lib/libcanard/drivers/stm32/canard_stm32.c **** #if (CANARD_STM32_CAN_TIR_RTR != CANARD_STM32_CAN_RIR_RTR) ||\
  94:Lib/libcanard/drivers/stm32/canard_stm32.c ****     (CANARD_STM32_CAN_TIR_IDE != CANARD_STM32_CAN_RIR_IDE)
  95:Lib/libcanard/drivers/stm32/canard_stm32.c **** # error "RIR bits do not match TIR bits, TIR --> libcanard conversion is not possible"
  96:Lib/libcanard/drivers/stm32/canard_stm32.c **** #endif
  97:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
  98:Lib/libcanard/drivers/stm32/canard_stm32.c ****     uint32_t out = 0;
 210              		.loc 1 98 5 view .LVU54
  99:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 100:Lib/libcanard/drivers/stm32/canard_stm32.c ****     if ((id & CANARD_STM32_CAN_RIR_IDE) == 0)
 211              		.loc 1 100 5 view .LVU55
 212              		.loc 1 100 8 is_stmt 0 view .LVU56
 213 0000 10F0040F 		tst	r0, #4
 214 0004 07D1     		bne	.L17
 101:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 102:Lib/libcanard/drivers/stm32/canard_stm32.c ****         out = (CANARD_CAN_STD_ID_MASK & (id >> 21U));
 215              		.loc 1 102 9 is_stmt 1 view .LVU57
 216              		.loc 1 102 13 is_stmt 0 view .LVU58
 217 0006 430D     		lsrs	r3, r0, #21
 218              	.LVL23:
 219              	.L18:
 103:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 104:Lib/libcanard/drivers/stm32/canard_stm32.c ****     else
 105:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 106:Lib/libcanard/drivers/stm32/canard_stm32.c ****         out = (CANARD_CAN_EXT_ID_MASK & (id >> 3U)) | CANARD_CAN_FRAME_EFF;
 107:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 108:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 109:Lib/libcanard/drivers/stm32/canard_stm32.c ****     if ((id & CANARD_STM32_CAN_RIR_RTR) != 0)
ARM GAS  /tmp/ccGBICaP.s 			page 7


 220              		.loc 1 109 5 is_stmt 1 view .LVU59
 221              		.loc 1 109 8 is_stmt 0 view .LVU60
 222 0008 10F0020F 		tst	r0, #2
 223 000c 01D0     		beq	.L16
 110:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 111:Lib/libcanard/drivers/stm32/canard_stm32.c ****         out |= CANARD_CAN_FRAME_RTR;
 224              		.loc 1 111 9 is_stmt 1 view .LVU61
 225              		.loc 1 111 13 is_stmt 0 view .LVU62
 226 000e 43F08043 		orr	r3, r3, #1073741824
 227              	.LVL24:
 112:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 113:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 114:Lib/libcanard/drivers/stm32/canard_stm32.c ****     return out;
 228              		.loc 1 114 5 is_stmt 1 view .LVU63
 229              	.L16:
 115:Lib/libcanard/drivers/stm32/canard_stm32.c **** }
 230              		.loc 1 115 1 is_stmt 0 view .LVU64
 231 0012 1846     		mov	r0, r3
 232              	.LVL25:
 233              		.loc 1 115 1 view .LVU65
 234 0014 7047     		bx	lr
 235              	.LVL26:
 236              	.L17:
 106:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 237              		.loc 1 106 9 is_stmt 1 view .LVU66
 106:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 238              		.loc 1 106 45 is_stmt 0 view .LVU67
 239 0016 C308     		lsrs	r3, r0, #3
 106:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 240              		.loc 1 106 13 view .LVU68
 241 0018 43F00043 		orr	r3, r3, #-2147483648
 242              	.LVL27:
 106:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 243              		.loc 1 106 13 view .LVU69
 244 001c F4E7     		b	.L18
 245              		.cfi_endproc
 246              	.LFE3:
 248              		.section	.text.waitMSRINAKBitStateChange,"ax",%progbits
 249              		.align	1
 250              		.syntax unified
 251              		.thumb
 252              		.thumb_func
 253              		.fpu fpv4-sp-d16
 255              	waitMSRINAKBitStateChange:
 256              	.LVL28:
 257              	.LFB4:
 116:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 117:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 118:Lib/libcanard/drivers/stm32/canard_stm32.c **** static bool waitMSRINAKBitStateChange(volatile const CanardSTM32CANType* const bxcan, const bool ta
 119:Lib/libcanard/drivers/stm32/canard_stm32.c **** {
 258              		.loc 1 119 1 is_stmt 1 view -0
 259              		.cfi_startproc
 260              		@ args = 0, pretend = 0, frame = 0
 261              		@ frame_needed = 0, uses_anonymous_args = 0
 262              		@ link register save eliminated.
 120:Lib/libcanard/drivers/stm32/canard_stm32.c ****     /**
 121:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * A properly functioning bus will exhibit 11 consecutive recessive bits at the end of every co
ARM GAS  /tmp/ccGBICaP.s 			page 8


 122:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * or while the bus is idle. The 11 consecutive recessive bits are made up of:
 123:Lib/libcanard/drivers/stm32/canard_stm32.c ****      *  1 bit - acknowledgement delimiter
 124:Lib/libcanard/drivers/stm32/canard_stm32.c ****      *  7 bit - end of frame bits
 125:Lib/libcanard/drivers/stm32/canard_stm32.c ****      *  3 bit - inter frame space
 126:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * This adds up to 11; therefore, it is not really necessary to wait longer than a few frame TX
 127:Lib/libcanard/drivers/stm32/canard_stm32.c ****      */
 128:Lib/libcanard/drivers/stm32/canard_stm32.c ****     static const uint16_t TimeoutMilliseconds = 1000;
 263              		.loc 1 128 5 view .LVU71
 129:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 130:Lib/libcanard/drivers/stm32/canard_stm32.c ****     for (uint16_t wait_ack = 0; wait_ack < TimeoutMilliseconds; wait_ack++)
 264              		.loc 1 130 5 view .LVU72
 265              	.LBB4:
 266              		.loc 1 130 10 view .LVU73
 267              		.loc 1 130 19 is_stmt 0 view .LVU74
 268 0000 0022     		movs	r2, #0
 269              	.LVL29:
 270              	.L21:
 271              		.loc 1 130 5 discriminator 1 view .LVU75
 272 0002 B2F57A7F 		cmp	r2, #1000
 273 0006 08D2     		bcs	.L25
 274              	.LBB5:
 131:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 132:Lib/libcanard/drivers/stm32/canard_stm32.c ****         const bool state = (bxcan->MSR & CANARD_STM32_CAN_MSR_INAK) != 0;
 275              		.loc 1 132 9 is_stmt 1 view .LVU76
 276              		.loc 1 132 34 is_stmt 0 view .LVU77
 277 0008 4368     		ldr	r3, [r0, #4]
 278              		.loc 1 132 40 view .LVU78
 279 000a 03F00103 		and	r3, r3, #1
 280              		.loc 1 132 20 view .LVU79
 281 000e DBB2     		uxtb	r3, r3
 282              	.LVL30:
 133:Lib/libcanard/drivers/stm32/canard_stm32.c ****         if (state == target_state)
 283              		.loc 1 133 9 is_stmt 1 view .LVU80
 284              		.loc 1 133 12 is_stmt 0 view .LVU81
 285 0010 8B42     		cmp	r3, r1
 286 0012 04D0     		beq	.L24
 134:Lib/libcanard/drivers/stm32/canard_stm32.c ****         {
 135:Lib/libcanard/drivers/stm32/canard_stm32.c ****             return true;
 136:Lib/libcanard/drivers/stm32/canard_stm32.c ****         }
 137:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 138:Lib/libcanard/drivers/stm32/canard_stm32.c ****         // Sleep 1 millisecond
 139:Lib/libcanard/drivers/stm32/canard_stm32.c ****         //usleep(1000);           // TODO: This function may be missing on some platforms
 140:Lib/libcanard/drivers/stm32/canard_stm32.c ****         int a=0; a++; a=a*2.3;	
 287              		.loc 1 140 9 is_stmt 1 discriminator 2 view .LVU82
 288              	.LVL31:
 289              		.loc 1 140 18 discriminator 2 view .LVU83
 290              		.loc 1 140 23 discriminator 2 view .LVU84
 291              		.loc 1 140 23 is_stmt 0 discriminator 2 view .LVU85
 292              	.LBE5:
 130:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 293              		.loc 1 130 73 discriminator 2 view .LVU86
 294 0014 0132     		adds	r2, r2, #1
 295              	.LVL32:
 130:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 296              		.loc 1 130 73 discriminator 2 view .LVU87
 297 0016 92B2     		uxth	r2, r2
 298              	.LVL33:
ARM GAS  /tmp/ccGBICaP.s 			page 9


 130:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 299              		.loc 1 130 73 discriminator 2 view .LVU88
 300 0018 F3E7     		b	.L21
 301              	.LVL34:
 302              	.L25:
 130:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 303              		.loc 1 130 73 discriminator 2 view .LVU89
 304              	.LBE4:
 141:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 142:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 143:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 144:Lib/libcanard/drivers/stm32/canard_stm32.c ****     return false;
 305              		.loc 1 144 12 view .LVU90
 306 001a 0020     		movs	r0, #0
 307              	.LVL35:
 308              	.LBB7:
 309              		.loc 1 144 12 view .LVU91
 310 001c 7047     		bx	lr
 311              	.LVL36:
 312              	.L24:
 313              	.LBB6:
 135:Lib/libcanard/drivers/stm32/canard_stm32.c ****         }
 314              		.loc 1 135 20 view .LVU92
 315 001e 0120     		movs	r0, #1
 316              	.LVL37:
 135:Lib/libcanard/drivers/stm32/canard_stm32.c ****         }
 317              		.loc 1 135 20 view .LVU93
 318              	.LBE6:
 319              	.LBE7:
 145:Lib/libcanard/drivers/stm32/canard_stm32.c **** }
 320              		.loc 1 145 1 view .LVU94
 321 0020 7047     		bx	lr
 322              		.cfi_endproc
 323              	.LFE4:
 325              		.section	.text.processErrorStatus,"ax",%progbits
 326              		.align	1
 327              		.syntax unified
 328              		.thumb
 329              		.thumb_func
 330              		.fpu fpv4-sp-d16
 332              	processErrorStatus:
 333              	.LFB5:
 146:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 147:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 148:Lib/libcanard/drivers/stm32/canard_stm32.c **** static void processErrorStatus(void)
 149:Lib/libcanard/drivers/stm32/canard_stm32.c **** {
 334              		.loc 1 149 1 is_stmt 1 view -0
 335              		.cfi_startproc
 336              		@ args = 0, pretend = 0, frame = 0
 337              		@ frame_needed = 0, uses_anonymous_args = 0
 338              		@ link register save eliminated.
 150:Lib/libcanard/drivers/stm32/canard_stm32.c ****     /*
 151:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * Aborting TX transmissions if abort on error was requested
 152:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * Updating error counter
 153:Lib/libcanard/drivers/stm32/canard_stm32.c ****      */
 154:Lib/libcanard/drivers/stm32/canard_stm32.c ****     const uint8_t lec = (uint8_t)((BXCAN->ESR & CANARD_STM32_CAN_ESR_LEC_MASK) >> CANARD_STM32_CAN_
 339              		.loc 1 154 5 view .LVU96
ARM GAS  /tmp/ccGBICaP.s 			page 10


 340              		.loc 1 154 41 is_stmt 0 view .LVU97
 341 0000 0D4B     		ldr	r3, .L29
 342 0002 9B69     		ldr	r3, [r3, #24]
 343              	.LVL38:
 155:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 156:Lib/libcanard/drivers/stm32/canard_stm32.c ****     if (lec != 0)
 344              		.loc 1 156 5 is_stmt 1 view .LVU98
 345              		.loc 1 156 8 is_stmt 0 view .LVU99
 346 0004 13F0700F 		tst	r3, #112
 347 0008 15D0     		beq	.L26
 157:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 158:Lib/libcanard/drivers/stm32/canard_stm32.c ****         BXCAN->ESR = 0;                 // This action does only affect the LEC bits, other bits ar
 348              		.loc 1 158 9 is_stmt 1 view .LVU100
 349              		.loc 1 158 20 is_stmt 0 view .LVU101
 350 000a 0B4B     		ldr	r3, .L29
 351              	.LVL39:
 352              		.loc 1 158 20 view .LVU102
 353 000c 0022     		movs	r2, #0
 354 000e 9A61     		str	r2, [r3, #24]
 159:Lib/libcanard/drivers/stm32/canard_stm32.c ****         g_stats.error_count++;
 355              		.loc 1 159 9 is_stmt 1 view .LVU103
 356              		.loc 1 159 16 is_stmt 0 view .LVU104
 357 0010 0A4A     		ldr	r2, .L29+4
 358 0012 9368     		ldr	r3, [r2, #8]
 359 0014 D168     		ldr	r1, [r2, #12]
 360              		.loc 1 159 28 view .LVU105
 361 0016 0133     		adds	r3, r3, #1
 362 0018 41F10001 		adc	r1, r1, #0
 363 001c 9360     		str	r3, [r2, #8]
 364 001e D160     		str	r1, [r2, #12]
 160:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 161:Lib/libcanard/drivers/stm32/canard_stm32.c ****         // Abort pending transmissions if auto abort on error is enabled, or if we're in bus off mo
 162:Lib/libcanard/drivers/stm32/canard_stm32.c ****         if (g_abort_tx_on_error || (BXCAN->ESR & CANARD_STM32_CAN_ESR_BOFF))
 365              		.loc 1 162 9 is_stmt 1 view .LVU106
 366              		.loc 1 162 13 is_stmt 0 view .LVU107
 367 0020 074B     		ldr	r3, .L29+8
 368 0022 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 369              		.loc 1 162 12 view .LVU108
 370 0024 23B9     		cbnz	r3, .L28
 371              		.loc 1 162 42 discriminator 1 view .LVU109
 372 0026 044B     		ldr	r3, .L29
 373 0028 9B69     		ldr	r3, [r3, #24]
 374              		.loc 1 162 33 discriminator 1 view .LVU110
 375 002a 13F0040F 		tst	r3, #4
 376 002e 02D0     		beq	.L26
 377              	.L28:
 163:Lib/libcanard/drivers/stm32/canard_stm32.c ****         {
 164:Lib/libcanard/drivers/stm32/canard_stm32.c ****             BXCAN->TSR = CANARD_STM32_CAN_TSR_ABRQ0 | CANARD_STM32_CAN_TSR_ABRQ1 | CANARD_STM32_CAN
 378              		.loc 1 164 13 is_stmt 1 view .LVU111
 379              		.loc 1 164 24 is_stmt 0 view .LVU112
 380 0030 014B     		ldr	r3, .L29
 381 0032 044A     		ldr	r2, .L29+12
 382 0034 9A60     		str	r2, [r3, #8]
 383              	.L26:
 165:Lib/libcanard/drivers/stm32/canard_stm32.c ****         }
 166:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 167:Lib/libcanard/drivers/stm32/canard_stm32.c **** }
ARM GAS  /tmp/ccGBICaP.s 			page 11


 384              		.loc 1 167 1 view .LVU113
 385 0036 7047     		bx	lr
 386              	.L30:
 387              		.align	2
 388              	.L29:
 389 0038 00640040 		.word	1073767424
 390 003c 00000000 		.word	.LANCHOR0
 391 0040 00000000 		.word	.LANCHOR1
 392 0044 80808000 		.word	8421504
 393              		.cfi_endproc
 394              	.LFE5:
 396              		.section	.text.canardSTM32Init,"ax",%progbits
 397              		.align	1
 398              		.global	canardSTM32Init
 399              		.syntax unified
 400              		.thumb
 401              		.thumb_func
 402              		.fpu fpv4-sp-d16
 404              	canardSTM32Init:
 405              	.LVL40:
 406              	.LFB6:
 168:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 169:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 170:Lib/libcanard/drivers/stm32/canard_stm32.c **** int16_t canardSTM32Init(const CanardSTM32CANTimings* const timings,
 171:Lib/libcanard/drivers/stm32/canard_stm32.c ****                         const CanardSTM32IfaceMode iface_mode)
 172:Lib/libcanard/drivers/stm32/canard_stm32.c **** {
 407              		.loc 1 172 1 is_stmt 1 view -0
 408              		.cfi_startproc
 409              		@ args = 0, pretend = 0, frame = 0
 410              		@ frame_needed = 0, uses_anonymous_args = 0
 173:Lib/libcanard/drivers/stm32/canard_stm32.c ****     /*
 174:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * Paranoia time.
 175:Lib/libcanard/drivers/stm32/canard_stm32.c ****      */
 176:Lib/libcanard/drivers/stm32/canard_stm32.c ****     if ((iface_mode != CanardSTM32IfaceModeNormal) &&
 411              		.loc 1 176 5 view .LVU115
 412              		.loc 1 176 8 is_stmt 0 view .LVU116
 413 0000 0229     		cmp	r1, #2
 414 0002 00F2B480 		bhi	.L38
 177:Lib/libcanard/drivers/stm32/canard_stm32.c ****         (iface_mode != CanardSTM32IfaceModeSilent) &&
 178:Lib/libcanard/drivers/stm32/canard_stm32.c ****         (iface_mode != CanardSTM32IfaceModeAutomaticTxAbortOnError))
 179:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 180:Lib/libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_ERROR_INVALID_ARGUMENT;
 181:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 182:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 183:Lib/libcanard/drivers/stm32/canard_stm32.c ****     if ((timings == NULL) ||
 415              		.loc 1 183 5 is_stmt 1 view .LVU117
 416              		.loc 1 183 8 is_stmt 0 view .LVU118
 417 0006 0028     		cmp	r0, #0
 418 0008 00F0B480 		beq	.L39
 172:Lib/libcanard/drivers/stm32/canard_stm32.c ****     /*
 419              		.loc 1 172 1 discriminator 1 view .LVU119
 420 000c 38B5     		push	{r3, r4, r5, lr}
 421              	.LCFI3:
 422              		.cfi_def_cfa_offset 16
 423              		.cfi_offset 3, -16
 424              		.cfi_offset 4, -12
 425              		.cfi_offset 5, -8
ARM GAS  /tmp/ccGBICaP.s 			page 12


 426              		.cfi_offset 14, -4
 184:Lib/libcanard/drivers/stm32/canard_stm32.c ****         (timings->bit_rate_prescaler < 1) || (timings->bit_rate_prescaler > 1024) ||
 427              		.loc 1 184 17 discriminator 1 view .LVU120
 428 000e 0388     		ldrh	r3, [r0]
 183:Lib/libcanard/drivers/stm32/canard_stm32.c ****         (timings->bit_rate_prescaler < 1) || (timings->bit_rate_prescaler > 1024) ||
 429              		.loc 1 183 27 discriminator 1 view .LVU121
 430 0010 002B     		cmp	r3, #0
 431 0012 00F0B280 		beq	.L40
 432              		.loc 1 184 43 view .LVU122
 433 0016 B3F5806F 		cmp	r3, #1024
 434 001a 00F2B180 		bhi	.L41
 185:Lib/libcanard/drivers/stm32/canard_stm32.c ****         (timings->max_resynchronization_jump_width < 1) || (timings->max_resynchronization_jump_wid
 435              		.loc 1 185 17 discriminator 1 view .LVU123
 436 001e 0379     		ldrb	r3, [r0, #4]	@ zero_extendqisi2
 184:Lib/libcanard/drivers/stm32/canard_stm32.c ****         (timings->bit_rate_prescaler < 1) || (timings->bit_rate_prescaler > 1024) ||
 437              		.loc 1 184 83 discriminator 1 view .LVU124
 438 0020 002B     		cmp	r3, #0
 439 0022 00F0B080 		beq	.L42
 440              		.loc 1 185 57 view .LVU125
 441 0026 042B     		cmp	r3, #4
 442 0028 00F2B080 		bhi	.L43
 186:Lib/libcanard/drivers/stm32/canard_stm32.c ****         (timings->bit_segment_1 < 1) || (timings->bit_segment_1 > 16) ||
 443              		.loc 1 186 17 discriminator 1 view .LVU126
 444 002c 8378     		ldrb	r3, [r0, #2]	@ zero_extendqisi2
 185:Lib/libcanard/drivers/stm32/canard_stm32.c ****         (timings->max_resynchronization_jump_width < 1) || (timings->max_resynchronization_jump_wid
 445              		.loc 1 185 108 discriminator 1 view .LVU127
 446 002e 002B     		cmp	r3, #0
 447 0030 00F0AF80 		beq	.L44
 448              		.loc 1 186 38 view .LVU128
 449 0034 102B     		cmp	r3, #16
 450 0036 00F2AF80 		bhi	.L45
 187:Lib/libcanard/drivers/stm32/canard_stm32.c ****         (timings->bit_segment_2 < 1) || (timings->bit_segment_2 > 8))
 451              		.loc 1 187 17 discriminator 1 view .LVU129
 452 003a C378     		ldrb	r3, [r0, #3]	@ zero_extendqisi2
 186:Lib/libcanard/drivers/stm32/canard_stm32.c ****         (timings->bit_segment_1 < 1) || (timings->bit_segment_1 > 16) ||
 453              		.loc 1 186 71 discriminator 1 view .LVU130
 454 003c 002B     		cmp	r3, #0
 455 003e 00F0AE80 		beq	.L46
 456              		.loc 1 187 38 view .LVU131
 457 0042 082B     		cmp	r3, #8
 458 0044 00F2AE80 		bhi	.L47
 459 0048 0C46     		mov	r4, r1
 460 004a 0546     		mov	r5, r0
 188:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 189:Lib/libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_ERROR_INVALID_ARGUMENT;
 190:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 191:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 192:Lib/libcanard/drivers/stm32/canard_stm32.c ****     /*
 193:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * Initial setup
 194:Lib/libcanard/drivers/stm32/canard_stm32.c ****      */
 195:Lib/libcanard/drivers/stm32/canard_stm32.c ****     memset(&g_stats, 0, sizeof(g_stats));
 461              		.loc 1 195 5 is_stmt 1 view .LVU132
 462 004c 574A     		ldr	r2, .L58
 463 004e 0023     		movs	r3, #0
 464 0050 1360     		str	r3, [r2]
 465 0052 5360     		str	r3, [r2, #4]
 466 0054 9360     		str	r3, [r2, #8]
ARM GAS  /tmp/ccGBICaP.s 			page 13


 467 0056 D360     		str	r3, [r2, #12]
 196:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 197:Lib/libcanard/drivers/stm32/canard_stm32.c ****     g_abort_tx_on_error = (iface_mode == CanardSTM32IfaceModeAutomaticTxAbortOnError);
 468              		.loc 1 197 5 view .LVU133
 469              		.loc 1 197 39 is_stmt 0 view .LVU134
 470 0058 0229     		cmp	r1, #2
 471 005a 14BF     		ite	ne
 472 005c 0021     		movne	r1, #0
 473              	.LVL41:
 474              		.loc 1 197 39 view .LVU135
 475 005e 0121     		moveq	r1, #1
 476              		.loc 1 197 25 view .LVU136
 477 0060 534A     		ldr	r2, .L58+4
 478 0062 1170     		strb	r1, [r2]
 198:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 199:Lib/libcanard/drivers/stm32/canard_stm32.c **** #if CANARD_STM32_USE_CAN2
 200:Lib/libcanard/drivers/stm32/canard_stm32.c ****     // If we're using CAN2, we MUST initialize CAN1 first, because CAN2 is a slave to CAN1.
 201:Lib/libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->IER = 0;                                 // We need no interrupts
 202:Lib/libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->MCR &= ~CANARD_STM32_CAN_MCR_SLEEP;      // Exit sleep mode
 203:Lib/libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->MCR |= CANARD_STM32_CAN_MCR_INRQ;        // Request init
 204:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 205:Lib/libcanard/drivers/stm32/canard_stm32.c ****     if (!waitMSRINAKBitStateChange(CANARD_STM32_CAN1, true))    // Wait for synchronization
 206:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 207:Lib/libcanard/drivers/stm32/canard_stm32.c ****         CANARD_STM32_CAN1->MCR = CANARD_STM32_CAN_MCR_RESET;
 208:Lib/libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_STM32_ERROR_MSR_INAK_NOT_SET;
 209:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 210:Lib/libcanard/drivers/stm32/canard_stm32.c ****     // CAN1 will be left in the initialization mode forever, in this mode it does not affect the bu
 211:Lib/libcanard/drivers/stm32/canard_stm32.c **** #endif
 212:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 213:Lib/libcanard/drivers/stm32/canard_stm32.c ****     BXCAN->IER = 0;                                             // We need no interrupts
 479              		.loc 1 213 5 is_stmt 1 view .LVU137
 480              		.loc 1 213 16 is_stmt 0 view .LVU138
 481 0064 5348     		ldr	r0, .L58+8
 482              	.LVL42:
 483              		.loc 1 213 16 view .LVU139
 484 0066 4361     		str	r3, [r0, #20]
 214:Lib/libcanard/drivers/stm32/canard_stm32.c ****     BXCAN->MCR &= ~CANARD_STM32_CAN_MCR_SLEEP;                  // Exit sleep mode
 485              		.loc 1 214 5 is_stmt 1 view .LVU140
 486              		.loc 1 214 16 is_stmt 0 view .LVU141
 487 0068 0368     		ldr	r3, [r0]
 488 006a 23F00203 		bic	r3, r3, #2
 489 006e 0360     		str	r3, [r0]
 215:Lib/libcanard/drivers/stm32/canard_stm32.c ****     BXCAN->MCR |= CANARD_STM32_CAN_MCR_INRQ;                    // Request init
 490              		.loc 1 215 5 is_stmt 1 view .LVU142
 491              		.loc 1 215 16 is_stmt 0 view .LVU143
 492 0070 0368     		ldr	r3, [r0]
 493 0072 43F00103 		orr	r3, r3, #1
 494 0076 0360     		str	r3, [r0]
 216:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 217:Lib/libcanard/drivers/stm32/canard_stm32.c ****     if (!waitMSRINAKBitStateChange(BXCAN, true))                // Wait for synchronization
 495              		.loc 1 217 5 is_stmt 1 view .LVU144
 496              		.loc 1 217 10 is_stmt 0 view .LVU145
 497 0078 0121     		movs	r1, #1
 498 007a FFF7FEFF 		bl	waitMSRINAKBitStateChange
 499              	.LVL43:
 500              		.loc 1 217 8 view .LVU146
 501 007e 0028     		cmp	r0, #0
ARM GAS  /tmp/ccGBICaP.s 			page 14


 502 0080 57D0     		beq	.L53
 218:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 219:Lib/libcanard/drivers/stm32/canard_stm32.c ****         BXCAN->MCR = CANARD_STM32_CAN_MCR_RESET;
 220:Lib/libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_STM32_ERROR_MSR_INAK_NOT_SET;
 221:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 222:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 223:Lib/libcanard/drivers/stm32/canard_stm32.c ****     /*
 224:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * Hardware initialization (the hardware has already confirmed initialization mode, see above)
 225:Lib/libcanard/drivers/stm32/canard_stm32.c ****      */
 226:Lib/libcanard/drivers/stm32/canard_stm32.c ****     BXCAN->MCR = CANARD_STM32_CAN_MCR_ABOM | CANARD_STM32_CAN_MCR_AWUM | CANARD_STM32_CAN_MCR_INRQ;
 503              		.loc 1 226 5 is_stmt 1 view .LVU147
 504              		.loc 1 226 16 is_stmt 0 view .LVU148
 505 0082 4C4B     		ldr	r3, .L58+8
 506 0084 6122     		movs	r2, #97
 507 0086 1A60     		str	r2, [r3]
 227:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 228:Lib/libcanard/drivers/stm32/canard_stm32.c ****     BXCAN->BTR = (((timings->max_resynchronization_jump_width - 1U) &    3U) << 24U) |
 508              		.loc 1 228 5 is_stmt 1 view .LVU149
 509              		.loc 1 228 28 is_stmt 0 view .LVU150
 510 0088 2B79     		ldrb	r3, [r5, #4]	@ zero_extendqisi2
 511              		.loc 1 228 63 view .LVU151
 512 008a 013B     		subs	r3, r3, #1
 513              		.loc 1 228 78 view .LVU152
 514 008c 1B06     		lsls	r3, r3, #24
 515 008e 03F04073 		and	r3, r3, #50331648
 229:Lib/libcanard/drivers/stm32/canard_stm32.c ****                  (((timings->bit_segment_1 - 1U)                    &   15U) << 16U) |
 516              		.loc 1 229 28 view .LVU153
 517 0092 AA78     		ldrb	r2, [r5, #2]	@ zero_extendqisi2
 518              		.loc 1 229 44 view .LVU154
 519 0094 013A     		subs	r2, r2, #1
 520              		.loc 1 229 78 view .LVU155
 521 0096 1204     		lsls	r2, r2, #16
 522 0098 02F47022 		and	r2, r2, #983040
 228:Lib/libcanard/drivers/stm32/canard_stm32.c ****                  (((timings->bit_segment_1 - 1U)                    &   15U) << 16U) |
 523              		.loc 1 228 86 view .LVU156
 524 009c 1343     		orrs	r3, r3, r2
 230:Lib/libcanard/drivers/stm32/canard_stm32.c ****                  (((timings->bit_segment_2 - 1U)                    &    7U) << 20U) |
 525              		.loc 1 230 28 view .LVU157
 526 009e EA78     		ldrb	r2, [r5, #3]	@ zero_extendqisi2
 527              		.loc 1 230 44 view .LVU158
 528 00a0 013A     		subs	r2, r2, #1
 529              		.loc 1 230 78 view .LVU159
 530 00a2 1205     		lsls	r2, r2, #20
 531 00a4 02F4E002 		and	r2, r2, #7340032
 229:Lib/libcanard/drivers/stm32/canard_stm32.c ****                  (((timings->bit_segment_1 - 1U)                    &   15U) << 16U) |
 532              		.loc 1 229 86 view .LVU160
 533 00a8 1343     		orrs	r3, r3, r2
 231:Lib/libcanard/drivers/stm32/canard_stm32.c ****                  ((timings->bit_rate_prescaler - 1U)                & 1023U) |
 534              		.loc 1 231 27 view .LVU161
 535 00aa 2A88     		ldrh	r2, [r5]
 536              		.loc 1 231 48 view .LVU162
 537 00ac 013A     		subs	r2, r2, #1
 538              		.loc 1 231 69 view .LVU163
 539 00ae C2F30902 		ubfx	r2, r2, #0, #10
 230:Lib/libcanard/drivers/stm32/canard_stm32.c ****                  (((timings->bit_segment_2 - 1U)                    &    7U) << 20U) |
 540              		.loc 1 230 86 view .LVU164
 541 00b2 1343     		orrs	r3, r3, r2
ARM GAS  /tmp/ccGBICaP.s 			page 15


 232:Lib/libcanard/drivers/stm32/canard_stm32.c ****                  ((iface_mode == CanardSTM32IfaceModeSilent) ? CANARD_STM32_CAN_BTR_SILM : 0);
 542              		.loc 1 232 90 view .LVU165
 543 00b4 012C     		cmp	r4, #1
 544 00b6 43D0     		beq	.L54
 545 00b8 0022     		movs	r2, #0
 546              	.L34:
 231:Lib/libcanard/drivers/stm32/canard_stm32.c ****                  ((timings->bit_rate_prescaler - 1U)                & 1023U) |
 547              		.loc 1 231 78 view .LVU166
 548 00ba 1343     		orrs	r3, r3, r2
 228:Lib/libcanard/drivers/stm32/canard_stm32.c ****                  (((timings->bit_segment_1 - 1U)                    &   15U) << 16U) |
 549              		.loc 1 228 16 view .LVU167
 550 00bc 3D4A     		ldr	r2, .L58+8
 551 00be D361     		str	r3, [r2, #28]
 233:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 234:Lib/libcanard/drivers/stm32/canard_stm32.c ****     CANARD_ASSERT(0 == BXCAN->IER);             // Making sure the iterrupts are indeed disabled
 552              		.loc 1 234 5 is_stmt 1 view .LVU168
 553 00c0 5369     		ldr	r3, [r2, #20]
 554 00c2 002B     		cmp	r3, #0
 555 00c4 3FD1     		bne	.L55
 235:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 236:Lib/libcanard/drivers/stm32/canard_stm32.c ****     BXCAN->MCR &= ~CANARD_STM32_CAN_MCR_INRQ;   // Leave init mode
 556              		.loc 1 236 5 view .LVU169
 557              		.loc 1 236 16 is_stmt 0 view .LVU170
 558 00c6 3B48     		ldr	r0, .L58+8
 559 00c8 0368     		ldr	r3, [r0]
 560 00ca 23F00103 		bic	r3, r3, #1
 561 00ce 0360     		str	r3, [r0]
 237:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 238:Lib/libcanard/drivers/stm32/canard_stm32.c ****     if (!waitMSRINAKBitStateChange(BXCAN, false))
 562              		.loc 1 238 5 is_stmt 1 view .LVU171
 563              		.loc 1 238 10 is_stmt 0 view .LVU172
 564 00d0 0021     		movs	r1, #0
 565 00d2 FFF7FEFF 		bl	waitMSRINAKBitStateChange
 566              	.LVL44:
 567              		.loc 1 238 8 view .LVU173
 568 00d6 0028     		cmp	r0, #0
 569 00d8 3BD0     		beq	.L56
 570              	.LBB8:
 239:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 240:Lib/libcanard/drivers/stm32/canard_stm32.c ****         BXCAN->MCR = CANARD_STM32_CAN_MCR_RESET;
 241:Lib/libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_STM32_ERROR_MSR_INAK_NOT_CLEARED;
 242:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 243:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 244:Lib/libcanard/drivers/stm32/canard_stm32.c ****     /*
 245:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * Default filter configuration. Note that ALL filters are available ONLY via CAN1!
 246:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * CAN2 filters are offset by 14.
 247:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * We use 14 filters at most always which simplifies the code and ensures compatibility with al
 248:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * MCU within the STM32 family.
 249:Lib/libcanard/drivers/stm32/canard_stm32.c ****      */
 250:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 251:Lib/libcanard/drivers/stm32/canard_stm32.c ****         uint32_t fmr = CANARD_STM32_CAN1->FMR & 0xFFFFC0F1U;
 571              		.loc 1 251 9 is_stmt 1 view .LVU174
 572              		.loc 1 251 41 is_stmt 0 view .LVU175
 573 00da 364A     		ldr	r2, .L58+8
 574 00dc D2F80032 		ldr	r3, [r2, #512]
 575              		.loc 1 251 18 view .LVU176
 576 00e0 23F47C53 		bic	r3, r3, #16128
ARM GAS  /tmp/ccGBICaP.s 			page 16


 577 00e4 23F00E03 		bic	r3, r3, #14
 578              	.LVL45:
 252:Lib/libcanard/drivers/stm32/canard_stm32.c ****         fmr |= CANARD_STM32_NUM_ACCEPTANCE_FILTERS << 8U;                // CAN2 start bank = 14 (i
 579              		.loc 1 252 9 is_stmt 1 view .LVU177
 253:Lib/libcanard/drivers/stm32/canard_stm32.c ****         CANARD_STM32_CAN1->FMR = fmr | CANARD_STM32_CAN_FMR_FINIT;
 580              		.loc 1 253 9 view .LVU178
 581              		.loc 1 253 38 is_stmt 0 view .LVU179
 582 00e8 43F46063 		orr	r3, r3, #3584
 583              	.LVL46:
 584              		.loc 1 253 38 view .LVU180
 585 00ec 43F00103 		orr	r3, r3, #1
 586              	.LVL47:
 587              		.loc 1 253 32 view .LVU181
 588 00f0 C2F80032 		str	r3, [r2, #512]
 589              	.LBE8:
 254:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 255:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 256:Lib/libcanard/drivers/stm32/canard_stm32.c ****     CANARD_ASSERT(((CANARD_STM32_CAN1->FMR >> 8U) & 0x3FU) == CANARD_STM32_NUM_ACCEPTANCE_FILTERS);
 590              		.loc 1 256 5 is_stmt 1 view .LVU182
 591 00f4 D2F80032 		ldr	r3, [r2, #512]
 592 00f8 C3F30523 		ubfx	r3, r3, #8, #6
 593 00fc 0E2B     		cmp	r3, #14
 594 00fe 2FD1     		bne	.L57
 257:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 258:Lib/libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FM1R = 0;                                        // Indentifier Mask mode
 595              		.loc 1 258 5 view .LVU183
 596              		.loc 1 258 29 is_stmt 0 view .LVU184
 597 0100 2C4B     		ldr	r3, .L58+8
 598 0102 0020     		movs	r0, #0
 599 0104 C3F80402 		str	r0, [r3, #516]
 259:Lib/libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FS1R = 0x0FFFFFFF;                               // All 32-bit
 600              		.loc 1 259 5 is_stmt 1 view .LVU185
 601              		.loc 1 259 29 is_stmt 0 view .LVU186
 602 0108 6FF07042 		mvn	r2, #-268435456
 603 010c C3F80C22 		str	r2, [r3, #524]
 260:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 261:Lib/libcanard/drivers/stm32/canard_stm32.c ****     // Filters are alternating between FIFO0 and FIFO1 in order to equalize the load.
 262:Lib/libcanard/drivers/stm32/canard_stm32.c ****     // This will cause occasional priority inversion and frame reordering on reception,
 263:Lib/libcanard/drivers/stm32/canard_stm32.c ****     // but that is acceptable for UAVCAN, and a majority of other protocols will tolerate
 264:Lib/libcanard/drivers/stm32/canard_stm32.c ****     // this too, since there will be no reordering within the same CAN ID.
 265:Lib/libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FFA1R = 0x0AAAAAAA;
 604              		.loc 1 265 5 is_stmt 1 view .LVU187
 605              		.loc 1 265 30 is_stmt 0 view .LVU188
 606 0110 294A     		ldr	r2, .L58+12
 607 0112 C3F81422 		str	r2, [r3, #532]
 266:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 267:Lib/libcanard/drivers/stm32/canard_stm32.c **** #if CANARD_STM32_USE_CAN2
 268:Lib/libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FilterRegister[CANARD_STM32_NUM_ACCEPTANCE_FILTERS].FR1 = 0;
 269:Lib/libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FilterRegister[CANARD_STM32_NUM_ACCEPTANCE_FILTERS].FR2 = 0;
 270:Lib/libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FA1R = (1 << CANARD_STM32_NUM_ACCEPTANCE_FILTERS);  // One filter enabled
 271:Lib/libcanard/drivers/stm32/canard_stm32.c **** #else
 272:Lib/libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FilterRegister[0].FR1 = 0;
 608              		.loc 1 272 5 is_stmt 1 view .LVU189
 609              		.loc 1 272 46 is_stmt 0 view .LVU190
 610 0116 C3F84002 		str	r0, [r3, #576]
 273:Lib/libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FilterRegister[0].FR2 = 0;
 611              		.loc 1 273 5 is_stmt 1 view .LVU191
ARM GAS  /tmp/ccGBICaP.s 			page 17


 612              		.loc 1 273 46 is_stmt 0 view .LVU192
 613 011a C3F84402 		str	r0, [r3, #580]
 274:Lib/libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FA1R = 1;                                        // One filter enabled
 614              		.loc 1 274 5 is_stmt 1 view .LVU193
 615              		.loc 1 274 29 is_stmt 0 view .LVU194
 616 011e 0122     		movs	r2, #1
 617 0120 C3F81C22 		str	r2, [r3, #540]
 275:Lib/libcanard/drivers/stm32/canard_stm32.c **** #endif
 276:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 277:Lib/libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FMR &= ~CANARD_STM32_CAN_FMR_FINIT;              // Leave initialization mod
 618              		.loc 1 277 5 is_stmt 1 view .LVU195
 619              		.loc 1 277 28 is_stmt 0 view .LVU196
 620 0124 D3F80022 		ldr	r2, [r3, #512]
 621 0128 22F00102 		bic	r2, r2, #1
 622 012c C3F80022 		str	r2, [r3, #512]
 278:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 279:Lib/libcanard/drivers/stm32/canard_stm32.c ****     return 0;
 623              		.loc 1 279 5 is_stmt 1 view .LVU197
 624              	.LVL48:
 625              	.L32:
 280:Lib/libcanard/drivers/stm32/canard_stm32.c **** }
 626              		.loc 1 280 1 is_stmt 0 view .LVU198
 627 0130 38BD     		pop	{r3, r4, r5, pc}
 628              	.LVL49:
 629              	.L53:
 219:Lib/libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_STM32_ERROR_MSR_INAK_NOT_SET;
 630              		.loc 1 219 9 is_stmt 1 view .LVU199
 219:Lib/libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_STM32_ERROR_MSR_INAK_NOT_SET;
 631              		.loc 1 219 20 is_stmt 0 view .LVU200
 632 0132 204B     		ldr	r3, .L58+8
 633 0134 4FF40042 		mov	r2, #32768
 634 0138 1A60     		str	r2, [r3]
 220:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 635              		.loc 1 220 9 is_stmt 1 view .LVU201
 220:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 636              		.loc 1 220 16 is_stmt 0 view .LVU202
 637 013a 6FF47A70 		mvn	r0, #1000
 638 013e F7E7     		b	.L32
 639              	.L54:
 232:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 640              		.loc 1 232 90 view .LVU203
 641 0140 4FF00042 		mov	r2, #-2147483648
 642 0144 B9E7     		b	.L34
 643              	.L55:
 234:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 644              		.loc 1 234 5 discriminator 1 view .LVU204
 645 0146 1D4B     		ldr	r3, .L58+16
 646 0148 1D4A     		ldr	r2, .L58+20
 647 014a EA21     		movs	r1, #234
 648 014c 1D48     		ldr	r0, .L58+24
 649 014e FFF7FEFF 		bl	__assert_func
 650              	.LVL50:
 651              	.L56:
 240:Lib/libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_STM32_ERROR_MSR_INAK_NOT_CLEARED;
 652              		.loc 1 240 9 is_stmt 1 view .LVU205
 240:Lib/libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_STM32_ERROR_MSR_INAK_NOT_CLEARED;
 653              		.loc 1 240 20 is_stmt 0 view .LVU206
ARM GAS  /tmp/ccGBICaP.s 			page 18


 654 0152 184B     		ldr	r3, .L58+8
 655 0154 4FF40042 		mov	r2, #32768
 656 0158 1A60     		str	r2, [r3]
 241:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 657              		.loc 1 241 9 is_stmt 1 view .LVU207
 241:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 658              		.loc 1 241 16 is_stmt 0 view .LVU208
 659 015a A0F2EA30 		subw	r0, r0, #1002
 660 015e E7E7     		b	.L32
 661              	.L57:
 256:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 662              		.loc 1 256 5 discriminator 1 view .LVU209
 663 0160 194B     		ldr	r3, .L58+28
 664 0162 174A     		ldr	r2, .L58+20
 665 0164 4FF48071 		mov	r1, #256
 666 0168 1648     		ldr	r0, .L58+24
 667 016a FFF7FEFF 		bl	__assert_func
 668              	.LVL51:
 669              	.L38:
 670              	.LCFI4:
 671              		.cfi_def_cfa_offset 0
 672              		.cfi_restore 3
 673              		.cfi_restore 4
 674              		.cfi_restore 5
 675              		.cfi_restore 14
 180:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 676              		.loc 1 180 16 view .LVU210
 677 016e 6FF00100 		mvn	r0, #1
 678              	.LVL52:
 180:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 679              		.loc 1 180 16 view .LVU211
 680 0172 7047     		bx	lr
 681              	.LVL53:
 682              	.L39:
 189:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 683              		.loc 1 189 16 view .LVU212
 684 0174 6FF00100 		mvn	r0, #1
 685              	.LVL54:
 686              		.loc 1 280 1 view .LVU213
 687 0178 7047     		bx	lr
 688              	.LVL55:
 689              	.L40:
 690              	.LCFI5:
 691              		.cfi_def_cfa_offset 16
 692              		.cfi_offset 3, -16
 693              		.cfi_offset 4, -12
 694              		.cfi_offset 5, -8
 695              		.cfi_offset 14, -4
 189:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 696              		.loc 1 189 16 view .LVU214
 697 017a 6FF00100 		mvn	r0, #1
 698              	.LVL56:
 189:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 699              		.loc 1 189 16 view .LVU215
 700 017e D7E7     		b	.L32
 701              	.LVL57:
 702              	.L41:
ARM GAS  /tmp/ccGBICaP.s 			page 19


 189:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 703              		.loc 1 189 16 view .LVU216
 704 0180 6FF00100 		mvn	r0, #1
 705              	.LVL58:
 189:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 706              		.loc 1 189 16 view .LVU217
 707 0184 D4E7     		b	.L32
 708              	.LVL59:
 709              	.L42:
 189:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 710              		.loc 1 189 16 view .LVU218
 711 0186 6FF00100 		mvn	r0, #1
 712              	.LVL60:
 189:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 713              		.loc 1 189 16 view .LVU219
 714 018a D1E7     		b	.L32
 715              	.LVL61:
 716              	.L43:
 189:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 717              		.loc 1 189 16 view .LVU220
 718 018c 6FF00100 		mvn	r0, #1
 719              	.LVL62:
 189:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 720              		.loc 1 189 16 view .LVU221
 721 0190 CEE7     		b	.L32
 722              	.LVL63:
 723              	.L44:
 189:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 724              		.loc 1 189 16 view .LVU222
 725 0192 6FF00100 		mvn	r0, #1
 726              	.LVL64:
 189:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 727              		.loc 1 189 16 view .LVU223
 728 0196 CBE7     		b	.L32
 729              	.LVL65:
 730              	.L45:
 189:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 731              		.loc 1 189 16 view .LVU224
 732 0198 6FF00100 		mvn	r0, #1
 733              	.LVL66:
 189:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 734              		.loc 1 189 16 view .LVU225
 735 019c C8E7     		b	.L32
 736              	.LVL67:
 737              	.L46:
 189:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 738              		.loc 1 189 16 view .LVU226
 739 019e 6FF00100 		mvn	r0, #1
 740              	.LVL68:
 189:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 741              		.loc 1 189 16 view .LVU227
 742 01a2 C5E7     		b	.L32
 743              	.LVL69:
 744              	.L47:
 189:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 745              		.loc 1 189 16 view .LVU228
 746 01a4 6FF00100 		mvn	r0, #1
ARM GAS  /tmp/ccGBICaP.s 			page 20


 747              	.LVL70:
 189:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 748              		.loc 1 189 16 view .LVU229
 749 01a8 C2E7     		b	.L32
 750              	.L59:
 751 01aa 00BF     		.align	2
 752              	.L58:
 753 01ac 00000000 		.word	.LANCHOR0
 754 01b0 00000000 		.word	.LANCHOR1
 755 01b4 00640040 		.word	1073767424
 756 01b8 AAAAAA0A 		.word	178956970
 757 01bc 00000000 		.word	.LC0
 758 01c0 00000000 		.word	.LANCHOR2
 759 01c4 38000000 		.word	.LC1
 760 01c8 64000000 		.word	.LC2
 761              		.cfi_endproc
 762              	.LFE6:
 764              		.section	.text.canardSTM32Transmit,"ax",%progbits
 765              		.align	1
 766              		.global	canardSTM32Transmit
 767              		.syntax unified
 768              		.thumb
 769              		.thumb_func
 770              		.fpu fpv4-sp-d16
 772              	canardSTM32Transmit:
 773              	.LVL71:
 774              	.LFB7:
 281:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 282:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 283:Lib/libcanard/drivers/stm32/canard_stm32.c **** int16_t canardSTM32Transmit(const CanardCANFrame* const frame)
 284:Lib/libcanard/drivers/stm32/canard_stm32.c **** {
 775              		.loc 1 284 1 is_stmt 1 view -0
 776              		.cfi_startproc
 777              		@ args = 0, pretend = 0, frame = 8
 778              		@ frame_needed = 0, uses_anonymous_args = 0
 285:Lib/libcanard/drivers/stm32/canard_stm32.c ****     if (frame == NULL)
 779              		.loc 1 285 5 view .LVU231
 780              		.loc 1 285 8 is_stmt 0 view .LVU232
 781 0000 0028     		cmp	r0, #0
 782 0002 75D0     		beq	.L67
 284:Lib/libcanard/drivers/stm32/canard_stm32.c ****     if (frame == NULL)
 783              		.loc 1 284 1 view .LVU233
 784 0004 70B5     		push	{r4, r5, r6, lr}
 785              	.LCFI6:
 786              		.cfi_def_cfa_offset 16
 787              		.cfi_offset 4, -16
 788              		.cfi_offset 5, -12
 789              		.cfi_offset 6, -8
 790              		.cfi_offset 14, -4
 791 0006 82B0     		sub	sp, sp, #8
 792              	.LCFI7:
 793              		.cfi_def_cfa_offset 24
 794 0008 0446     		mov	r4, r0
 286:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 287:Lib/libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_ERROR_INVALID_ARGUMENT;
 288:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 289:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
ARM GAS  /tmp/ccGBICaP.s 			page 21


 290:Lib/libcanard/drivers/stm32/canard_stm32.c ****     if (frame->id & CANARD_CAN_FRAME_ERR)
 795              		.loc 1 290 5 is_stmt 1 view .LVU234
 796              		.loc 1 290 14 is_stmt 0 view .LVU235
 797 000a 0368     		ldr	r3, [r0]
 798              		.loc 1 290 8 view .LVU236
 799 000c 13F0005F 		tst	r3, #536870912
 800 0010 71D1     		bne	.L68
 291:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 292:Lib/libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_STM32_ERROR_UNSUPPORTED_FRAME_FORMAT;
 293:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 294:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 295:Lib/libcanard/drivers/stm32/canard_stm32.c ****     /*
 296:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * Handling error status might free up some slots through aborts
 297:Lib/libcanard/drivers/stm32/canard_stm32.c ****      */
 298:Lib/libcanard/drivers/stm32/canard_stm32.c ****     processErrorStatus();
 801              		.loc 1 298 5 is_stmt 1 view .LVU237
 802 0012 FFF7FEFF 		bl	processErrorStatus
 803              	.LVL72:
 299:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 300:Lib/libcanard/drivers/stm32/canard_stm32.c ****     /*
 301:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * Seeking an empty slot, checking if priority inversion would occur if we enqueued now.
 302:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * We can always enqueue safely if all TX mailboxes are free and no transmissions are pending.
 303:Lib/libcanard/drivers/stm32/canard_stm32.c ****      */
 304:Lib/libcanard/drivers/stm32/canard_stm32.c ****     uint8_t tx_mailbox = 0xFF;
 804              		.loc 1 304 5 view .LVU238
 305:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 306:Lib/libcanard/drivers/stm32/canard_stm32.c ****     static const uint32_t AllTME = CANARD_STM32_CAN_TSR_TME0 | CANARD_STM32_CAN_TSR_TME1 | CANARD_S
 805              		.loc 1 306 5 view .LVU239
 307:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 308:Lib/libcanard/drivers/stm32/canard_stm32.c ****     if ((BXCAN->TSR & AllTME) != AllTME)                // At least one TX mailbox is used, detaile
 806              		.loc 1 308 5 view .LVU240
 807              		.loc 1 308 15 is_stmt 0 view .LVU241
 808 0016 394B     		ldr	r3, .L78
 809 0018 9B68     		ldr	r3, [r3, #8]
 810              		.loc 1 308 21 view .LVU242
 811 001a 03F0E053 		and	r3, r3, #469762048
 812              		.loc 1 308 8 view .LVU243
 813 001e B3F1E05F 		cmp	r3, #469762048
 814 0022 63D0     		beq	.L69
 815              	.LBB9:
 309:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 310:Lib/libcanard/drivers/stm32/canard_stm32.c ****         const bool tme[3] =
 816              		.loc 1 310 9 is_stmt 1 view .LVU244
 311:Lib/libcanard/drivers/stm32/canard_stm32.c ****         {
 312:Lib/libcanard/drivers/stm32/canard_stm32.c ****             (BXCAN->TSR & CANARD_STM32_CAN_TSR_TME0) != 0,
 817              		.loc 1 312 19 is_stmt 0 view .LVU245
 818 0024 354B     		ldr	r3, .L78
 819 0026 9A68     		ldr	r2, [r3, #8]
 820              		.loc 1 312 54 view .LVU246
 821 0028 C2F38062 		ubfx	r2, r2, #26, #1
 310:Lib/libcanard/drivers/stm32/canard_stm32.c ****         {
 822              		.loc 1 310 20 view .LVU247
 823 002c 8DF80420 		strb	r2, [sp, #4]
 313:Lib/libcanard/drivers/stm32/canard_stm32.c ****             (BXCAN->TSR & CANARD_STM32_CAN_TSR_TME1) != 0,
 824              		.loc 1 313 19 view .LVU248
 825 0030 9A68     		ldr	r2, [r3, #8]
 826              		.loc 1 313 54 view .LVU249
ARM GAS  /tmp/ccGBICaP.s 			page 22


 827 0032 C2F3C062 		ubfx	r2, r2, #27, #1
 310:Lib/libcanard/drivers/stm32/canard_stm32.c ****         {
 828              		.loc 1 310 20 view .LVU250
 829 0036 8DF80520 		strb	r2, [sp, #5]
 314:Lib/libcanard/drivers/stm32/canard_stm32.c ****             (BXCAN->TSR & CANARD_STM32_CAN_TSR_TME2) != 0
 830              		.loc 1 314 19 view .LVU251
 831 003a 9B68     		ldr	r3, [r3, #8]
 832              		.loc 1 314 54 view .LVU252
 833 003c C3F30073 		ubfx	r3, r3, #28, #1
 310:Lib/libcanard/drivers/stm32/canard_stm32.c ****         {
 834              		.loc 1 310 20 view .LVU253
 835 0040 8DF80630 		strb	r3, [sp, #6]
 315:Lib/libcanard/drivers/stm32/canard_stm32.c ****         };
 316:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 317:Lib/libcanard/drivers/stm32/canard_stm32.c ****         for (uint8_t i = 0; i < 3; i++)
 836              		.loc 1 317 9 is_stmt 1 view .LVU254
 837              	.LBB10:
 838              		.loc 1 317 14 view .LVU255
 839              	.LVL73:
 840              		.loc 1 317 22 is_stmt 0 view .LVU256
 841 0044 0025     		movs	r5, #0
 842              	.LBE10:
 843              	.LBE9:
 304:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 844              		.loc 1 304 13 view .LVU257
 845 0046 FF26     		movs	r6, #255
 846              	.LBB12:
 847              	.LBB11:
 848              		.loc 1 317 9 view .LVU258
 849 0048 02E0     		b	.L63
 850              	.LVL74:
 851              	.L70:
 318:Lib/libcanard/drivers/stm32/canard_stm32.c ****         {
 319:Lib/libcanard/drivers/stm32/canard_stm32.c ****             if (tme[i])                                 // This TX mailbox is free, we can use it
 320:Lib/libcanard/drivers/stm32/canard_stm32.c ****             {
 321:Lib/libcanard/drivers/stm32/canard_stm32.c ****                 tx_mailbox = i;
 852              		.loc 1 321 28 view .LVU259
 853 004a 2E46     		mov	r6, r5
 854              	.LVL75:
 855              	.L64:
 317:Lib/libcanard/drivers/stm32/canard_stm32.c ****         {
 856              		.loc 1 317 37 discriminator 2 view .LVU260
 857 004c 0135     		adds	r5, r5, #1
 858              	.LVL76:
 317:Lib/libcanard/drivers/stm32/canard_stm32.c ****         {
 859              		.loc 1 317 37 discriminator 2 view .LVU261
 860 004e EDB2     		uxtb	r5, r5
 861              	.LVL77:
 862              	.L63:
 317:Lib/libcanard/drivers/stm32/canard_stm32.c ****         {
 863              		.loc 1 317 9 discriminator 1 view .LVU262
 864 0050 022D     		cmp	r5, #2
 865 0052 13D8     		bhi	.L75
 319:Lib/libcanard/drivers/stm32/canard_stm32.c ****             {
 866              		.loc 1 319 13 is_stmt 1 view .LVU263
 319:Lib/libcanard/drivers/stm32/canard_stm32.c ****             {
 867              		.loc 1 319 20 is_stmt 0 view .LVU264
ARM GAS  /tmp/ccGBICaP.s 			page 23


 868 0054 02AB     		add	r3, sp, #8
 869 0056 2B44     		add	r3, r3, r5
 870 0058 13F8043C 		ldrb	r3, [r3, #-4]	@ zero_extendqisi2
 319:Lib/libcanard/drivers/stm32/canard_stm32.c ****             {
 871              		.loc 1 319 16 view .LVU265
 872 005c 002B     		cmp	r3, #0
 873 005e F4D1     		bne	.L70
 322:Lib/libcanard/drivers/stm32/canard_stm32.c ****             }
 323:Lib/libcanard/drivers/stm32/canard_stm32.c ****             else                                        // This TX mailbox is pending, check for pr
 324:Lib/libcanard/drivers/stm32/canard_stm32.c ****             {
 325:Lib/libcanard/drivers/stm32/canard_stm32.c ****                 if (!isFramePriorityHigher(frame->id, convertFrameIDRegisterToCanard(BXCAN->TxMailb
 874              		.loc 1 325 17 is_stmt 1 view .LVU266
 875              		.loc 1 325 22 is_stmt 0 view .LVU267
 876 0060 05F11803 		add	r3, r5, #24
 877 0064 1B01     		lsls	r3, r3, #4
 878 0066 254A     		ldr	r2, .L78
 879 0068 D058     		ldr	r0, [r2, r3]
 880 006a FFF7FEFF 		bl	convertFrameIDRegisterToCanard
 881              	.LVL78:
 882 006e 0146     		mov	r1, r0
 883 0070 2068     		ldr	r0, [r4]
 884 0072 FFF7FEFF 		bl	isFramePriorityHigher
 885              	.LVL79:
 886              		.loc 1 325 20 view .LVU268
 887 0076 0028     		cmp	r0, #0
 888 0078 E8D1     		bne	.L64
 889 007a 27E0     		b	.L61
 890              	.L75:
 891              		.loc 1 325 20 view .LVU269
 892              	.LBE11:
 326:Lib/libcanard/drivers/stm32/canard_stm32.c ****                 {
 327:Lib/libcanard/drivers/stm32/canard_stm32.c ****                     // There's a mailbox whose priority is higher or equal the priority of the new 
 328:Lib/libcanard/drivers/stm32/canard_stm32.c ****                     return 0;                           // Priority inversion would occur! Reject t
 329:Lib/libcanard/drivers/stm32/canard_stm32.c ****                 }
 330:Lib/libcanard/drivers/stm32/canard_stm32.c ****             }
 331:Lib/libcanard/drivers/stm32/canard_stm32.c ****         }
 332:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 333:Lib/libcanard/drivers/stm32/canard_stm32.c ****         if (tx_mailbox == 0xFF)
 893              		.loc 1 333 9 is_stmt 1 view .LVU270
 894              		.loc 1 333 12 is_stmt 0 view .LVU271
 895 007c FF2E     		cmp	r6, #255
 896 007e 27D0     		beq	.L76
 897              		.loc 1 333 12 view .LVU272
 898              	.LBE12:
 334:Lib/libcanard/drivers/stm32/canard_stm32.c ****         {
 335:Lib/libcanard/drivers/stm32/canard_stm32.c ****             /*
 336:Lib/libcanard/drivers/stm32/canard_stm32.c ****              * All TX mailboxes are busy (this is highly unlikely); at the same time we know that t
 337:Lib/libcanard/drivers/stm32/canard_stm32.c ****              * higher or equal priority frame that is currently pending. Therefore, priority invers
 338:Lib/libcanard/drivers/stm32/canard_stm32.c ****              * just happend (sic!), because we can't enqueue the higher priority frame due to all T
 339:Lib/libcanard/drivers/stm32/canard_stm32.c ****              * being busy. This scenario is extremely unlikely, because in order for it to happen, 
 340:Lib/libcanard/drivers/stm32/canard_stm32.c ****              * would need to transmit 4 (four) or more CAN frames with different CAN ID ordered fro
 341:Lib/libcanard/drivers/stm32/canard_stm32.c ****              * low ID nearly at the same time. For example:
 342:Lib/libcanard/drivers/stm32/canard_stm32.c ****              *  1. 0x123        <-- Takes mailbox 0 (or any other)
 343:Lib/libcanard/drivers/stm32/canard_stm32.c ****              *  2. 0x122        <-- Takes mailbox 2 (or any other)
 344:Lib/libcanard/drivers/stm32/canard_stm32.c ****              *  3. 0x121        <-- Takes mailbox 1 (or any other)
 345:Lib/libcanard/drivers/stm32/canard_stm32.c ****              *  4. 0x120        <-- INNER PRIORITY INVERSION HERE (only if all three TX mailboxes a
 346:Lib/libcanard/drivers/stm32/canard_stm32.c ****              * This situation is even less likely to cause any noticeable disruptions on the CAN bu
ARM GAS  /tmp/ccGBICaP.s 			page 24


 347:Lib/libcanard/drivers/stm32/canard_stm32.c ****              * it is better to warn the developer about that during debugging, so we fire an assert
 348:Lib/libcanard/drivers/stm32/canard_stm32.c ****              * It is perfectly safe to remove it.
 349:Lib/libcanard/drivers/stm32/canard_stm32.c ****              */
 350:Lib/libcanard/drivers/stm32/canard_stm32.c **** #if CANARD_STM32_DEBUG_INNER_PRIORITY_INVERSION
 351:Lib/libcanard/drivers/stm32/canard_stm32.c ****             CANARD_ASSERT(!"CAN PRIO INV");
 352:Lib/libcanard/drivers/stm32/canard_stm32.c **** #endif
 353:Lib/libcanard/drivers/stm32/canard_stm32.c ****             return 0;
 354:Lib/libcanard/drivers/stm32/canard_stm32.c ****         }
 355:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 356:Lib/libcanard/drivers/stm32/canard_stm32.c ****     else                                                // All TX mailboxes are free, use first
 357:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 358:Lib/libcanard/drivers/stm32/canard_stm32.c ****         tx_mailbox = 0;
 359:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 360:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 361:Lib/libcanard/drivers/stm32/canard_stm32.c ****     CANARD_ASSERT(tx_mailbox < 3);                      // Index check - the value must be correct 
 899              		.loc 1 361 5 is_stmt 1 view .LVU273
 900 0080 022E     		cmp	r6, #2
 901 0082 2CD8     		bhi	.L77
 902              	.LVL80:
 903              	.L62:
 362:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 363:Lib/libcanard/drivers/stm32/canard_stm32.c ****     /*
 364:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * By this time we've proved that a priority inversion would not occur, and we've also found a 
 365:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * Therefore it is safe to enqueue the frame now.
 366:Lib/libcanard/drivers/stm32/canard_stm32.c ****      */
 367:Lib/libcanard/drivers/stm32/canard_stm32.c ****     volatile CanardSTM32TxMailboxType* const mb = &BXCAN->TxMailbox[tx_mailbox];
 904              		.loc 1 367 5 view .LVU274
 905              		.loc 1 367 51 is_stmt 0 view .LVU275
 906 0084 3501     		lsls	r5, r6, #4
 907              		.loc 1 367 46 view .LVU276
 908 0086 05F18045 		add	r5, r5, #1073741824
 909 008a 05F5CB45 		add	r5, r5, #25984
 910              	.LVL81:
 368:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 369:Lib/libcanard/drivers/stm32/canard_stm32.c ****     mb->TDTR = frame->data_len;                         // DLC equals data length except in CAN FD
 911              		.loc 1 369 5 is_stmt 1 view .LVU277
 912              		.loc 1 369 21 is_stmt 0 view .LVU278
 913 008e 237B     		ldrb	r3, [r4, #12]	@ zero_extendqisi2
 914              		.loc 1 369 14 view .LVU279
 915 0090 6B60     		str	r3, [r5, #4]
 370:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 371:Lib/libcanard/drivers/stm32/canard_stm32.c ****     mb->TDHR = (((uint32_t)frame->data[7]) << 24U) |
 916              		.loc 1 371 5 is_stmt 1 view .LVU280
 917              		.loc 1 371 39 is_stmt 0 view .LVU281
 918 0092 E27A     		ldrb	r2, [r4, #11]	@ zero_extendqisi2
 372:Lib/libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[6]) << 16U) |
 919              		.loc 1 372 39 view .LVU282
 920 0094 A37A     		ldrb	r3, [r4, #10]	@ zero_extendqisi2
 921              		.loc 1 372 44 view .LVU283
 922 0096 1B04     		lsls	r3, r3, #16
 371:Lib/libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[6]) << 16U) |
 923              		.loc 1 371 52 view .LVU284
 924 0098 43EA0263 		orr	r3, r3, r2, lsl #24
 373:Lib/libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[5]) <<  8U) |
 925              		.loc 1 373 39 view .LVU285
 926 009c 627A     		ldrb	r2, [r4, #9]	@ zero_extendqisi2
 372:Lib/libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[6]) << 16U) |
ARM GAS  /tmp/ccGBICaP.s 			page 25


 927              		.loc 1 372 52 view .LVU286
 928 009e 43EA0223 		orr	r3, r3, r2, lsl #8
 374:Lib/libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[4]) <<  0U);
 929              		.loc 1 374 39 view .LVU287
 930 00a2 227A     		ldrb	r2, [r4, #8]	@ zero_extendqisi2
 373:Lib/libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[5]) <<  8U) |
 931              		.loc 1 373 52 view .LVU288
 932 00a4 1343     		orrs	r3, r3, r2
 371:Lib/libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[6]) << 16U) |
 933              		.loc 1 371 14 view .LVU289
 934 00a6 EB60     		str	r3, [r5, #12]
 375:Lib/libcanard/drivers/stm32/canard_stm32.c ****     mb->TDLR = (((uint32_t)frame->data[3]) << 24U) |
 935              		.loc 1 375 5 is_stmt 1 view .LVU290
 936              		.loc 1 375 39 is_stmt 0 view .LVU291
 937 00a8 E279     		ldrb	r2, [r4, #7]	@ zero_extendqisi2
 376:Lib/libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[2]) << 16U) |
 938              		.loc 1 376 39 view .LVU292
 939 00aa A379     		ldrb	r3, [r4, #6]	@ zero_extendqisi2
 940              		.loc 1 376 44 view .LVU293
 941 00ac 1B04     		lsls	r3, r3, #16
 375:Lib/libcanard/drivers/stm32/canard_stm32.c ****     mb->TDLR = (((uint32_t)frame->data[3]) << 24U) |
 942              		.loc 1 375 52 view .LVU294
 943 00ae 43EA0263 		orr	r3, r3, r2, lsl #24
 377:Lib/libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[1]) <<  8U) |
 944              		.loc 1 377 39 view .LVU295
 945 00b2 6279     		ldrb	r2, [r4, #5]	@ zero_extendqisi2
 376:Lib/libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[2]) << 16U) |
 946              		.loc 1 376 52 view .LVU296
 947 00b4 43EA0223 		orr	r3, r3, r2, lsl #8
 378:Lib/libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[0]) <<  0U);
 948              		.loc 1 378 39 view .LVU297
 949 00b8 2279     		ldrb	r2, [r4, #4]	@ zero_extendqisi2
 377:Lib/libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[1]) <<  8U) |
 950              		.loc 1 377 52 view .LVU298
 951 00ba 1343     		orrs	r3, r3, r2
 375:Lib/libcanard/drivers/stm32/canard_stm32.c ****                (((uint32_t)frame->data[2]) << 16U) |
 952              		.loc 1 375 14 view .LVU299
 953 00bc AB60     		str	r3, [r5, #8]
 379:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 380:Lib/libcanard/drivers/stm32/canard_stm32.c ****     mb->TIR = convertFrameIDCanardToRegister(frame->id) | CANARD_STM32_CAN_TIR_TXRQ;    // Go.
 954              		.loc 1 380 5 is_stmt 1 view .LVU300
 955              		.loc 1 380 15 is_stmt 0 view .LVU301
 956 00be 2068     		ldr	r0, [r4]
 957 00c0 FFF7FEFF 		bl	convertFrameIDCanardToRegister
 958              	.LVL82:
 959              		.loc 1 380 57 view .LVU302
 960 00c4 40F00100 		orr	r0, r0, #1
 961              		.loc 1 380 13 view .LVU303
 962 00c8 2860     		str	r0, [r5]
 381:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 382:Lib/libcanard/drivers/stm32/canard_stm32.c ****     /*
 383:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * The frame is now enqueued and pending transmission.
 384:Lib/libcanard/drivers/stm32/canard_stm32.c ****      */
 385:Lib/libcanard/drivers/stm32/canard_stm32.c ****     return 1;
 963              		.loc 1 385 5 is_stmt 1 view .LVU304
 964              		.loc 1 385 12 is_stmt 0 view .LVU305
 965 00ca 0120     		movs	r0, #1
ARM GAS  /tmp/ccGBICaP.s 			page 26


 966              	.LVL83:
 967              	.L61:
 386:Lib/libcanard/drivers/stm32/canard_stm32.c **** }
 968              		.loc 1 386 1 view .LVU306
 969 00cc 02B0     		add	sp, sp, #8
 970              	.LCFI8:
 971              		.cfi_remember_state
 972              		.cfi_def_cfa_offset 16
 973              		@ sp needed
 974 00ce 70BD     		pop	{r4, r5, r6, pc}
 975              	.LVL84:
 976              	.L76:
 977              	.LCFI9:
 978              		.cfi_restore_state
 979              	.LBB13:
 351:Lib/libcanard/drivers/stm32/canard_stm32.c **** #endif
 980              		.loc 1 351 13 is_stmt 1 view .LVU307
 981 00d0 0B4B     		ldr	r3, .L78+4
 982 00d2 0C4A     		ldr	r2, .L78+8
 983 00d4 40F25F11 		movw	r1, #351
 984 00d8 0B48     		ldr	r0, .L78+12
 985 00da FFF7FEFF 		bl	__assert_func
 986              	.LVL85:
 987              	.L77:
 351:Lib/libcanard/drivers/stm32/canard_stm32.c **** #endif
 988              		.loc 1 351 13 is_stmt 0 view .LVU308
 989              	.LBE13:
 361:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 990              		.loc 1 361 5 discriminator 1 view .LVU309
 991 00de 0B4B     		ldr	r3, .L78+16
 992 00e0 084A     		ldr	r2, .L78+8
 993 00e2 40F26911 		movw	r1, #361
 994 00e6 0848     		ldr	r0, .L78+12
 995 00e8 FFF7FEFF 		bl	__assert_func
 996              	.LVL86:
 997              	.L69:
 358:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 998              		.loc 1 358 20 view .LVU310
 999 00ec 0026     		movs	r6, #0
 1000 00ee C9E7     		b	.L62
 1001              	.LVL87:
 1002              	.L67:
 1003              	.LCFI10:
 1004              		.cfi_def_cfa_offset 0
 1005              		.cfi_restore 4
 1006              		.cfi_restore 5
 1007              		.cfi_restore 6
 1008              		.cfi_restore 14
 287:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 1009              		.loc 1 287 16 view .LVU311
 1010 00f0 6FF00100 		mvn	r0, #1
 1011              	.LVL88:
 1012              		.loc 1 386 1 view .LVU312
 1013 00f4 7047     		bx	lr
 1014              	.LVL89:
 1015              	.L68:
 1016              	.LCFI11:
ARM GAS  /tmp/ccGBICaP.s 			page 27


 1017              		.cfi_def_cfa_offset 24
 1018              		.cfi_offset 4, -16
 1019              		.cfi_offset 5, -12
 1020              		.cfi_offset 6, -8
 1021              		.cfi_offset 14, -4
 292:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 1022              		.loc 1 292 16 view .LVU313
 1023 00f6 0648     		ldr	r0, .L78+20
 1024              	.LVL90:
 292:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 1025              		.loc 1 292 16 view .LVU314
 1026 00f8 E8E7     		b	.L61
 1027              	.L79:
 1028 00fa 00BF     		.align	2
 1029              	.L78:
 1030 00fc 00640040 		.word	1073767424
 1031 0100 00000000 		.word	.LC3
 1032 0104 00000000 		.word	.LANCHOR3
 1033 0108 38000000 		.word	.LC1
 1034 010c 10000000 		.word	.LC4
 1035 0110 15FCFFFF 		.word	-1003
 1036              		.cfi_endproc
 1037              	.LFE7:
 1039              		.section	.text.canardSTM32Receive,"ax",%progbits
 1040              		.align	1
 1041              		.global	canardSTM32Receive
 1042              		.syntax unified
 1043              		.thumb
 1044              		.thumb_func
 1045              		.fpu fpv4-sp-d16
 1047              	canardSTM32Receive:
 1048              	.LVL91:
 1049              	.LFB8:
 387:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 388:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 389:Lib/libcanard/drivers/stm32/canard_stm32.c **** int16_t canardSTM32Receive(CanardCANFrame* const out_frame)
 390:Lib/libcanard/drivers/stm32/canard_stm32.c **** {
 1050              		.loc 1 390 1 is_stmt 1 view -0
 1051              		.cfi_startproc
 1052              		@ args = 0, pretend = 0, frame = 0
 1053              		@ frame_needed = 0, uses_anonymous_args = 0
 391:Lib/libcanard/drivers/stm32/canard_stm32.c ****     if (out_frame == NULL)
 1054              		.loc 1 391 5 view .LVU316
 1055              		.loc 1 391 8 is_stmt 0 view .LVU317
 1056 0000 0028     		cmp	r0, #0
 1057 0002 40D0     		beq	.L86
 390:Lib/libcanard/drivers/stm32/canard_stm32.c ****     if (out_frame == NULL)
 1058              		.loc 1 390 1 view .LVU318
 1059 0004 70B5     		push	{r4, r5, r6, lr}
 1060              	.LCFI12:
 1061              		.cfi_def_cfa_offset 16
 1062              		.cfi_offset 4, -16
 1063              		.cfi_offset 5, -12
 1064              		.cfi_offset 6, -8
 1065              		.cfi_offset 14, -4
 1066 0006 0646     		mov	r6, r0
 392:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
ARM GAS  /tmp/ccGBICaP.s 			page 28


 393:Lib/libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_ERROR_INVALID_ARGUMENT;
 394:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 395:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 396:Lib/libcanard/drivers/stm32/canard_stm32.c ****     static volatile uint32_t* const RFxR[2] =
 1067              		.loc 1 396 5 is_stmt 1 view .LVU319
 397:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 398:Lib/libcanard/drivers/stm32/canard_stm32.c ****         &BXCAN->RF0R,
 399:Lib/libcanard/drivers/stm32/canard_stm32.c ****         &BXCAN->RF1R
 400:Lib/libcanard/drivers/stm32/canard_stm32.c ****     };
 401:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 402:Lib/libcanard/drivers/stm32/canard_stm32.c ****     /*
 403:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * This function must be polled periodically, so we use this opportunity to do it.
 404:Lib/libcanard/drivers/stm32/canard_stm32.c ****      */
 405:Lib/libcanard/drivers/stm32/canard_stm32.c ****     processErrorStatus();
 1068              		.loc 1 405 5 view .LVU320
 1069 0008 FFF7FEFF 		bl	processErrorStatus
 1070              	.LVL92:
 406:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 407:Lib/libcanard/drivers/stm32/canard_stm32.c ****     /*
 408:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * Reading the TX FIFO
 409:Lib/libcanard/drivers/stm32/canard_stm32.c ****      */
 410:Lib/libcanard/drivers/stm32/canard_stm32.c ****     for (uint_fast8_t i = 0; i < 2; i++)
 1071              		.loc 1 410 5 view .LVU321
 1072              	.LBB14:
 1073              		.loc 1 410 10 view .LVU322
 1074              		.loc 1 410 23 is_stmt 0 view .LVU323
 1075 000c 0023     		movs	r3, #0
 1076              	.LVL93:
 1077              	.L82:
 1078              		.loc 1 410 5 discriminator 1 view .LVU324
 1079 000e 012B     		cmp	r3, #1
 1080 0010 37D8     		bhi	.L91
 1081              	.LBB15:
 411:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 412:Lib/libcanard/drivers/stm32/canard_stm32.c ****         volatile CanardSTM32RxMailboxType* const mb = &BXCAN->RxMailbox[i];
 1082              		.loc 1 412 9 is_stmt 1 view .LVU325
 1083              		.loc 1 412 50 is_stmt 0 view .LVU326
 1084 0012 1E4C     		ldr	r4, .L93
 1085 0014 04EB0314 		add	r4, r4, r3, lsl #4
 1086              	.LVL94:
 413:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 414:Lib/libcanard/drivers/stm32/canard_stm32.c ****         if (((*RFxR[i]) & CANARD_STM32_CAN_RFR_FMP_MASK) != 0)
 1087              		.loc 1 414 9 is_stmt 1 view .LVU327
 1088              		.loc 1 414 20 is_stmt 0 view .LVU328
 1089 0018 1D4A     		ldr	r2, .L93+4
 1090 001a 52F82350 		ldr	r5, [r2, r3, lsl #2]
 1091              		.loc 1 414 15 view .LVU329
 1092 001e 2A68     		ldr	r2, [r5]
 1093              		.loc 1 414 12 view .LVU330
 1094 0020 12F0030F 		tst	r2, #3
 1095 0024 01D1     		bne	.L92
 1096              	.LBE15:
 410:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 1097              		.loc 1 410 38 discriminator 2 view .LVU331
 1098 0026 0133     		adds	r3, r3, #1
 1099              	.LVL95:
 410:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
ARM GAS  /tmp/ccGBICaP.s 			page 29


 1100              		.loc 1 410 38 discriminator 2 view .LVU332
 1101 0028 F1E7     		b	.L82
 1102              	.L92:
 1103              	.LBB17:
 1104              	.LBB16:
 415:Lib/libcanard/drivers/stm32/canard_stm32.c ****         {
 416:Lib/libcanard/drivers/stm32/canard_stm32.c ****             if (*RFxR[i] & CANARD_STM32_CAN_RFR_FOVR)
 1105              		.loc 1 416 13 is_stmt 1 view .LVU333
 1106              		.loc 1 416 17 is_stmt 0 view .LVU334
 1107 002a 2B68     		ldr	r3, [r5]
 1108              	.LVL96:
 1109              		.loc 1 416 16 view .LVU335
 1110 002c 13F0100F 		tst	r3, #16
 1111 0030 07D0     		beq	.L84
 417:Lib/libcanard/drivers/stm32/canard_stm32.c ****             {
 418:Lib/libcanard/drivers/stm32/canard_stm32.c ****                 g_stats.rx_overflow_count++;
 1112              		.loc 1 418 17 is_stmt 1 view .LVU336
 1113              		.loc 1 418 24 is_stmt 0 view .LVU337
 1114 0032 184A     		ldr	r2, .L93+8
 1115 0034 1368     		ldr	r3, [r2]
 1116 0036 5168     		ldr	r1, [r2, #4]
 1117              		.loc 1 418 42 view .LVU338
 1118 0038 0133     		adds	r3, r3, #1
 1119 003a 41F10001 		adc	r1, r1, #0
 1120 003e 1360     		str	r3, [r2]
 1121 0040 5160     		str	r1, [r2, #4]
 1122              	.L84:
 419:Lib/libcanard/drivers/stm32/canard_stm32.c ****             }
 420:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 421:Lib/libcanard/drivers/stm32/canard_stm32.c ****             out_frame->id = convertFrameIDRegisterToCanard(mb->RIR);
 1123              		.loc 1 421 13 is_stmt 1 view .LVU339
 1124              		.loc 1 421 29 is_stmt 0 view .LVU340
 1125 0042 2068     		ldr	r0, [r4]
 1126 0044 FFF7FEFF 		bl	convertFrameIDRegisterToCanard
 1127              	.LVL97:
 1128              		.loc 1 421 27 view .LVU341
 1129 0048 3060     		str	r0, [r6]
 422:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 423:Lib/libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data_len = (uint8_t)(mb->RDTR & CANARD_STM32_CAN_RDTR_DLC_MASK);
 1130              		.loc 1 423 13 is_stmt 1 view .LVU342
 1131              		.loc 1 423 47 is_stmt 0 view .LVU343
 1132 004a 6368     		ldr	r3, [r4, #4]
 1133              		.loc 1 423 35 view .LVU344
 1134 004c 03F00F03 		and	r3, r3, #15
 1135              		.loc 1 423 33 view .LVU345
 1136 0050 3373     		strb	r3, [r6, #12]
 424:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 425:Lib/libcanard/drivers/stm32/canard_stm32.c ****             // Caching to regular (non volatile) memory for faster reads
 426:Lib/libcanard/drivers/stm32/canard_stm32.c ****             const uint32_t rdlr = mb->RDLR;
 1137              		.loc 1 426 13 is_stmt 1 view .LVU346
 1138              		.loc 1 426 28 is_stmt 0 view .LVU347
 1139 0052 A268     		ldr	r2, [r4, #8]
 1140              	.LVL98:
 427:Lib/libcanard/drivers/stm32/canard_stm32.c ****             const uint32_t rdhr = mb->RDHR;
 1141              		.loc 1 427 13 is_stmt 1 view .LVU348
 1142              		.loc 1 427 28 is_stmt 0 view .LVU349
 1143 0054 E368     		ldr	r3, [r4, #12]
ARM GAS  /tmp/ccGBICaP.s 			page 30


 1144              	.LVL99:
 428:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 429:Lib/libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data[0] = (uint8_t)(0xFFU & (rdlr >>  0U));
 1145              		.loc 1 429 13 is_stmt 1 view .LVU350
 1146              		.loc 1 429 32 is_stmt 0 view .LVU351
 1147 0056 3271     		strb	r2, [r6, #4]
 430:Lib/libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data[1] = (uint8_t)(0xFFU & (rdlr >>  8U));
 1148              		.loc 1 430 13 is_stmt 1 view .LVU352
 1149              		.loc 1 430 34 is_stmt 0 view .LVU353
 1150 0058 C2F30721 		ubfx	r1, r2, #8, #8
 1151              		.loc 1 430 32 view .LVU354
 1152 005c 7171     		strb	r1, [r6, #5]
 431:Lib/libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data[2] = (uint8_t)(0xFFU & (rdlr >> 16U));
 1153              		.loc 1 431 13 is_stmt 1 view .LVU355
 1154              		.loc 1 431 34 is_stmt 0 view .LVU356
 1155 005e C2F30741 		ubfx	r1, r2, #16, #8
 1156              		.loc 1 431 32 view .LVU357
 1157 0062 B171     		strb	r1, [r6, #6]
 432:Lib/libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data[3] = (uint8_t)(0xFFU & (rdlr >> 24U));
 1158              		.loc 1 432 13 is_stmt 1 view .LVU358
 1159              		.loc 1 432 34 is_stmt 0 view .LVU359
 1160 0064 120E     		lsrs	r2, r2, #24
 1161              	.LVL100:
 1162              		.loc 1 432 32 view .LVU360
 1163 0066 F271     		strb	r2, [r6, #7]
 433:Lib/libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data[4] = (uint8_t)(0xFFU & (rdhr >>  0U));
 1164              		.loc 1 433 13 is_stmt 1 view .LVU361
 1165              		.loc 1 433 32 is_stmt 0 view .LVU362
 1166 0068 3372     		strb	r3, [r6, #8]
 434:Lib/libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data[5] = (uint8_t)(0xFFU & (rdhr >>  8U));
 1167              		.loc 1 434 13 is_stmt 1 view .LVU363
 1168              		.loc 1 434 34 is_stmt 0 view .LVU364
 1169 006a C3F30722 		ubfx	r2, r3, #8, #8
 1170              		.loc 1 434 32 view .LVU365
 1171 006e 7272     		strb	r2, [r6, #9]
 435:Lib/libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data[6] = (uint8_t)(0xFFU & (rdhr >> 16U));
 1172              		.loc 1 435 13 is_stmt 1 view .LVU366
 1173              		.loc 1 435 34 is_stmt 0 view .LVU367
 1174 0070 C3F30742 		ubfx	r2, r3, #16, #8
 1175              		.loc 1 435 32 view .LVU368
 1176 0074 B272     		strb	r2, [r6, #10]
 436:Lib/libcanard/drivers/stm32/canard_stm32.c ****             out_frame->data[7] = (uint8_t)(0xFFU & (rdhr >> 24U));
 1177              		.loc 1 436 13 is_stmt 1 view .LVU369
 1178              		.loc 1 436 34 is_stmt 0 view .LVU370
 1179 0076 1B0E     		lsrs	r3, r3, #24
 1180              	.LVL101:
 1181              		.loc 1 436 32 view .LVU371
 1182 0078 F372     		strb	r3, [r6, #11]
 437:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 438:Lib/libcanard/drivers/stm32/canard_stm32.c ****             // Release FIFO entry we just read
 439:Lib/libcanard/drivers/stm32/canard_stm32.c ****             *RFxR[i] = CANARD_STM32_CAN_RFR_RFOM | CANARD_STM32_CAN_RFR_FOVR | CANARD_STM32_CAN_RFR
 1183              		.loc 1 439 13 is_stmt 1 view .LVU372
 1184              		.loc 1 439 22 is_stmt 0 view .LVU373
 1185 007a 3823     		movs	r3, #56
 1186 007c 2B60     		str	r3, [r5]
 440:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 441:Lib/libcanard/drivers/stm32/canard_stm32.c ****             // Reading successful
ARM GAS  /tmp/ccGBICaP.s 			page 31


 442:Lib/libcanard/drivers/stm32/canard_stm32.c ****             return 1;
 1187              		.loc 1 442 13 is_stmt 1 view .LVU374
 1188              		.loc 1 442 20 is_stmt 0 view .LVU375
 1189 007e 0120     		movs	r0, #1
 1190 0080 00E0     		b	.L81
 1191              	.LVL102:
 1192              	.L91:
 1193              		.loc 1 442 20 view .LVU376
 1194              	.LBE16:
 1195              	.LBE17:
 1196              	.LBE14:
 443:Lib/libcanard/drivers/stm32/canard_stm32.c ****         }
 444:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 445:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 446:Lib/libcanard/drivers/stm32/canard_stm32.c ****     // No frames to read
 447:Lib/libcanard/drivers/stm32/canard_stm32.c ****     return 0;
 1197              		.loc 1 447 12 view .LVU377
 1198 0082 0020     		movs	r0, #0
 1199              	.LVL103:
 1200              	.L81:
 448:Lib/libcanard/drivers/stm32/canard_stm32.c **** }
 1201              		.loc 1 448 1 view .LVU378
 1202 0084 70BD     		pop	{r4, r5, r6, pc}
 1203              	.LVL104:
 1204              	.L86:
 1205              	.LCFI13:
 1206              		.cfi_def_cfa_offset 0
 1207              		.cfi_restore 4
 1208              		.cfi_restore 5
 1209              		.cfi_restore 6
 1210              		.cfi_restore 14
 393:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 1211              		.loc 1 393 16 view .LVU379
 1212 0086 6FF00100 		mvn	r0, #1
 1213              	.LVL105:
 1214              		.loc 1 448 1 view .LVU380
 1215 008a 7047     		bx	lr
 1216              	.L94:
 1217              		.align	2
 1218              	.L93:
 1219 008c B0650040 		.word	1073767856
 1220 0090 00000000 		.word	.LANCHOR4
 1221 0094 00000000 		.word	.LANCHOR0
 1222              		.cfi_endproc
 1223              	.LFE8:
 1225              		.section	.text.canardSTM32ConfigureAcceptanceFilters,"ax",%progbits
 1226              		.align	1
 1227              		.global	canardSTM32ConfigureAcceptanceFilters
 1228              		.syntax unified
 1229              		.thumb
 1230              		.thumb_func
 1231              		.fpu fpv4-sp-d16
 1233              	canardSTM32ConfigureAcceptanceFilters:
 1234              	.LVL106:
 1235              	.LFB9:
 449:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 450:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
ARM GAS  /tmp/ccGBICaP.s 			page 32


 451:Lib/libcanard/drivers/stm32/canard_stm32.c **** int16_t canardSTM32ConfigureAcceptanceFilters(const CanardSTM32AcceptanceFilterConfiguration* const
 452:Lib/libcanard/drivers/stm32/canard_stm32.c ****                                               const uint8_t num_filter_configs)
 453:Lib/libcanard/drivers/stm32/canard_stm32.c **** {
 1236              		.loc 1 453 1 is_stmt 1 view -0
 1237              		.cfi_startproc
 1238              		@ args = 0, pretend = 0, frame = 0
 1239              		@ frame_needed = 0, uses_anonymous_args = 0
 1240              		@ link register save eliminated.
 454:Lib/libcanard/drivers/stm32/canard_stm32.c ****     // Note that num_filter_configs = 0 is a valid configuration, which rejects all frames.
 455:Lib/libcanard/drivers/stm32/canard_stm32.c ****     if ((filter_configs == NULL) ||
 1241              		.loc 1 455 5 view .LVU382
 1242              		.loc 1 455 8 is_stmt 0 view .LVU383
 1243 0000 0028     		cmp	r0, #0
 1244 0002 3FD0     		beq	.L105
 453:Lib/libcanard/drivers/stm32/canard_stm32.c ****     // Note that num_filter_configs = 0 is a valid configuration, which rejects all frames.
 1245              		.loc 1 453 1 discriminator 1 view .LVU384
 1246 0004 70B4     		push	{r4, r5, r6}
 1247              	.LCFI14:
 1248              		.cfi_def_cfa_offset 12
 1249              		.cfi_offset 4, -12
 1250              		.cfi_offset 5, -8
 1251              		.cfi_offset 6, -4
 1252 0006 0646     		mov	r6, r0
 1253              		.loc 1 455 34 discriminator 1 view .LVU385
 1254 0008 0E29     		cmp	r1, #14
 1255 000a 3ED8     		bhi	.L106
 456:Lib/libcanard/drivers/stm32/canard_stm32.c ****         (num_filter_configs > CANARD_STM32_NUM_ACCEPTANCE_FILTERS))
 457:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 458:Lib/libcanard/drivers/stm32/canard_stm32.c ****         return -CANARD_ERROR_INVALID_ARGUMENT;
 459:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 460:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 461:Lib/libcanard/drivers/stm32/canard_stm32.c ****     /*
 462:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * First we disable all filters. This may cause momentary RX frame losses, but the application
 463:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * should be able to tolerate that.
 464:Lib/libcanard/drivers/stm32/canard_stm32.c ****      */
 465:Lib/libcanard/drivers/stm32/canard_stm32.c ****     CANARD_STM32_CAN1->FA1R = 0;
 1256              		.loc 1 465 5 is_stmt 1 view .LVU386
 1257              		.loc 1 465 29 is_stmt 0 view .LVU387
 1258 000c 0023     		movs	r3, #0
 1259 000e 204A     		ldr	r2, .L113
 1260 0010 C2F81C32 		str	r3, [r2, #540]
 466:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 467:Lib/libcanard/drivers/stm32/canard_stm32.c ****     /*
 468:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * Having filters disabled we can update the configuration.
 469:Lib/libcanard/drivers/stm32/canard_stm32.c ****      * Register mapping: FR1 - ID, FR2 - Mask
 470:Lib/libcanard/drivers/stm32/canard_stm32.c ****      */
 471:Lib/libcanard/drivers/stm32/canard_stm32.c ****     for (uint8_t i = 0; i < num_filter_configs; i++)
 1261              		.loc 1 471 5 is_stmt 1 view .LVU388
 1262              	.LBB18:
 1263              		.loc 1 471 10 view .LVU389
 1264              	.LVL107:
 1265              		.loc 1 471 5 is_stmt 0 view .LVU390
 1266 0014 22E0     		b	.L97
 1267              	.LVL108:
 1268              	.L98:
 1269              	.LBB19:
 472:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
ARM GAS  /tmp/ccGBICaP.s 			page 33


 473:Lib/libcanard/drivers/stm32/canard_stm32.c ****         /*
 474:Lib/libcanard/drivers/stm32/canard_stm32.c ****          * Converting the ID and the Mask into the representation that can be chewed by the hardwar
 475:Lib/libcanard/drivers/stm32/canard_stm32.c ****          * If Mask asks us to accept both STDID and EXTID, we need to use EXT mode on the filter,
 476:Lib/libcanard/drivers/stm32/canard_stm32.c ****          * otherwise it will reject all EXTID frames. This logic is not documented in the RM.
 477:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *
 478:Lib/libcanard/drivers/stm32/canard_stm32.c ****          * The logic of the hardware acceptance filters can be described as follows:
 479:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *
 480:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *  accepted = (received_id & filter_mask) == (filter_id & filter_mask)
 481:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *
 482:Lib/libcanard/drivers/stm32/canard_stm32.c ****          * Where:
 483:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *  - accepted      - if true, the frame will be accepted by the filter.
 484:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *  - received_id   - the CAN ID of the received frame, either 11-bit or 29-bit, with exten
 485:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *                    marking extended frames, error frames, etc.
 486:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *  - filter_id     - the value of the filter ID register.
 487:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *  - filter_mask   - the value of the filter mask register.
 488:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *
 489:Lib/libcanard/drivers/stm32/canard_stm32.c ****          * There are special bits that are not members of the CAN ID field:
 490:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *  - EFF - set for extended frames (29-bit), cleared for standard frames (11-bit)
 491:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *  - RTR - like above, indicates Remote Transmission Request frames.
 492:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *
 493:Lib/libcanard/drivers/stm32/canard_stm32.c ****          * The following truth table summarizes the logic (where: FM - filter mask, FID - filter ID
 494:Lib/libcanard/drivers/stm32/canard_stm32.c ****          * frame ID, A - true if accepted, X - any state):
 495:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *
 496:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *  FM  FID RID A
 497:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *  0   X   X   1
 498:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *  1   0   0   1
 499:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *  1   1   0   0
 500:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *  1   0   1   0
 501:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *  1   1   1   1
 502:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *
 503:Lib/libcanard/drivers/stm32/canard_stm32.c ****          * One would expect that for the purposes of hardware filtering, the special bits should be
 504:Lib/libcanard/drivers/stm32/canard_stm32.c ****          * in the same way as the real ID bits. However, this is not the case with bxCAN. The follo
 505:Lib/libcanard/drivers/stm32/canard_stm32.c ****          * table has been determined empirically (this behavior was not documented as of 2017):
 506:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *
 507:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *  FM  FID RID A
 508:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *  0   0   0   1
 509:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *  0   0   1   0       <-- frame rejected!
 510:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *  0   1   X   1
 511:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *  1   0   0   1
 512:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *  1   1   0   0
 513:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *  1   0   1   0
 514:Lib/libcanard/drivers/stm32/canard_stm32.c ****          *  1   1   1   1
 515:Lib/libcanard/drivers/stm32/canard_stm32.c ****          */
 516:Lib/libcanard/drivers/stm32/canard_stm32.c ****         uint32_t id   = 0;
 517:Lib/libcanard/drivers/stm32/canard_stm32.c ****         uint32_t mask = 0;
 518:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 519:Lib/libcanard/drivers/stm32/canard_stm32.c ****         const CanardSTM32AcceptanceFilterConfiguration* const cfg = filter_configs + i;
 520:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 521:Lib/libcanard/drivers/stm32/canard_stm32.c ****         if ((cfg->id & CANARD_CAN_FRAME_EFF) || !(cfg->mask & CANARD_CAN_FRAME_EFF))
 522:Lib/libcanard/drivers/stm32/canard_stm32.c ****         {
 523:Lib/libcanard/drivers/stm32/canard_stm32.c ****             id   = (cfg->id   & CANARD_CAN_EXT_ID_MASK) << 3U;
 1270              		.loc 1 523 13 is_stmt 1 view .LVU391
 1271              		.loc 1 523 18 is_stmt 0 view .LVU392
 1272 0016 E000     		lsls	r0, r4, #3
 1273              	.LVL109:
 524:Lib/libcanard/drivers/stm32/canard_stm32.c ****             mask = (cfg->mask & CANARD_CAN_EXT_ID_MASK) << 3U;
 1274              		.loc 1 524 13 is_stmt 1 view .LVU393
ARM GAS  /tmp/ccGBICaP.s 			page 34


 1275              		.loc 1 524 24 is_stmt 0 view .LVU394
 1276 0018 6A68     		ldr	r2, [r5, #4]
 1277              		.loc 1 524 18 view .LVU395
 1278 001a D200     		lsls	r2, r2, #3
 1279              	.LVL110:
 525:Lib/libcanard/drivers/stm32/canard_stm32.c ****             id |= CANARD_STM32_CAN_RIR_IDE;
 1280              		.loc 1 525 13 is_stmt 1 view .LVU396
 1281              		.loc 1 525 16 is_stmt 0 view .LVU397
 1282 001c 40F00400 		orr	r0, r0, #4
 1283              	.LVL111:
 1284              	.L100:
 526:Lib/libcanard/drivers/stm32/canard_stm32.c ****         }
 527:Lib/libcanard/drivers/stm32/canard_stm32.c ****         else
 528:Lib/libcanard/drivers/stm32/canard_stm32.c ****         {
 529:Lib/libcanard/drivers/stm32/canard_stm32.c ****             id   = (cfg->id   & CANARD_CAN_STD_ID_MASK) << 21U;
 530:Lib/libcanard/drivers/stm32/canard_stm32.c ****             mask = (cfg->mask & CANARD_CAN_STD_ID_MASK) << 21U;
 531:Lib/libcanard/drivers/stm32/canard_stm32.c ****         }
 532:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 533:Lib/libcanard/drivers/stm32/canard_stm32.c ****         if (cfg->id & CANARD_CAN_FRAME_RTR)
 1285              		.loc 1 533 9 is_stmt 1 view .LVU398
 1286              		.loc 1 533 12 is_stmt 0 view .LVU399
 1287 0020 14F0804F 		tst	r4, #1073741824
 1288 0024 01D0     		beq	.L101
 534:Lib/libcanard/drivers/stm32/canard_stm32.c ****         {
 535:Lib/libcanard/drivers/stm32/canard_stm32.c ****             id |= CANARD_STM32_CAN_RIR_RTR;
 1289              		.loc 1 535 13 is_stmt 1 view .LVU400
 1290              		.loc 1 535 16 is_stmt 0 view .LVU401
 1291 0026 40F00200 		orr	r0, r0, #2
 1292              	.LVL112:
 1293              	.L101:
 536:Lib/libcanard/drivers/stm32/canard_stm32.c ****         }
 537:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 538:Lib/libcanard/drivers/stm32/canard_stm32.c ****         if (cfg->mask & CANARD_CAN_FRAME_EFF)
 1294              		.loc 1 538 9 is_stmt 1 view .LVU402
 1295              		.loc 1 538 16 is_stmt 0 view .LVU403
 1296 002a 6C68     		ldr	r4, [r5, #4]
 1297              		.loc 1 538 12 view .LVU404
 1298 002c 002C     		cmp	r4, #0
 1299 002e 23DB     		blt	.L111
 1300              	.L102:
 539:Lib/libcanard/drivers/stm32/canard_stm32.c ****         {
 540:Lib/libcanard/drivers/stm32/canard_stm32.c ****             mask |= CANARD_STM32_CAN_RIR_IDE;
 541:Lib/libcanard/drivers/stm32/canard_stm32.c ****         }
 542:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 543:Lib/libcanard/drivers/stm32/canard_stm32.c ****         if (cfg->mask & CANARD_CAN_FRAME_RTR)
 1301              		.loc 1 543 9 is_stmt 1 view .LVU405
 1302              		.loc 1 543 12 is_stmt 0 view .LVU406
 1303 0030 14F0804F 		tst	r4, #1073741824
 1304 0034 01D0     		beq	.L103
 544:Lib/libcanard/drivers/stm32/canard_stm32.c ****         {
 545:Lib/libcanard/drivers/stm32/canard_stm32.c ****             mask |= CANARD_STM32_CAN_RIR_RTR;
 1305              		.loc 1 545 13 is_stmt 1 view .LVU407
 1306              		.loc 1 545 18 is_stmt 0 view .LVU408
 1307 0036 42F00202 		orr	r2, r2, #2
 1308              	.LVL113:
 1309              	.L103:
 546:Lib/libcanard/drivers/stm32/canard_stm32.c ****         }
ARM GAS  /tmp/ccGBICaP.s 			page 35


 547:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 548:Lib/libcanard/drivers/stm32/canard_stm32.c ****         /*
 549:Lib/libcanard/drivers/stm32/canard_stm32.c ****          * Applying the converted representation to the registers.
 550:Lib/libcanard/drivers/stm32/canard_stm32.c ****          */
 551:Lib/libcanard/drivers/stm32/canard_stm32.c ****         const uint8_t filter_index =
 1310              		.loc 1 551 9 is_stmt 1 discriminator 2 view .LVU409
 552:Lib/libcanard/drivers/stm32/canard_stm32.c **** #if CANARD_STM32_USE_CAN2
 553:Lib/libcanard/drivers/stm32/canard_stm32.c ****             (uint8_t)(i + CANARD_STM32_NUM_ACCEPTANCE_FILTERS);
 554:Lib/libcanard/drivers/stm32/canard_stm32.c **** #else
 555:Lib/libcanard/drivers/stm32/canard_stm32.c ****             i;
 556:Lib/libcanard/drivers/stm32/canard_stm32.c **** #endif
 557:Lib/libcanard/drivers/stm32/canard_stm32.c ****         CANARD_STM32_CAN1->FilterRegister[filter_index].FR1 = id;
 1311              		.loc 1 557 9 discriminator 2 view .LVU410
 1312              		.loc 1 557 61 is_stmt 0 discriminator 2 view .LVU411
 1313 003a 154C     		ldr	r4, .L113
 1314 003c 03F14805 		add	r5, r3, #72
 1315              	.LVL114:
 1316              		.loc 1 557 61 discriminator 2 view .LVU412
 1317 0040 44F83500 		str	r0, [r4, r5, lsl #3]
 558:Lib/libcanard/drivers/stm32/canard_stm32.c ****         CANARD_STM32_CAN1->FilterRegister[filter_index].FR2 = mask;
 1318              		.loc 1 558 9 is_stmt 1 discriminator 2 view .LVU413
 1319              		.loc 1 558 61 is_stmt 0 discriminator 2 view .LVU414
 1320 0044 04EBC505 		add	r5, r4, r5, lsl #3
 1321 0048 6A60     		str	r2, [r5, #4]
 559:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 560:Lib/libcanard/drivers/stm32/canard_stm32.c ****         CANARD_STM32_CAN1->FA1R |= 1U << filter_index;      // Enable
 1322              		.loc 1 560 9 is_stmt 1 discriminator 2 view .LVU415
 1323              		.loc 1 560 33 is_stmt 0 discriminator 2 view .LVU416
 1324 004a D4F81C22 		ldr	r2, [r4, #540]
 1325              	.LVL115:
 1326              		.loc 1 560 39 discriminator 2 view .LVU417
 1327 004e 0120     		movs	r0, #1
 1328              	.LVL116:
 1329              		.loc 1 560 39 discriminator 2 view .LVU418
 1330 0050 9840     		lsls	r0, r0, r3
 1331              		.loc 1 560 33 discriminator 2 view .LVU419
 1332 0052 0243     		orrs	r2, r2, r0
 1333 0054 C4F81C22 		str	r2, [r4, #540]
 1334              	.LVL117:
 1335              		.loc 1 560 33 discriminator 2 view .LVU420
 1336              	.LBE19:
 471:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 1337              		.loc 1 471 50 discriminator 2 view .LVU421
 1338 0058 0133     		adds	r3, r3, #1
 1339              	.LVL118:
 471:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 1340              		.loc 1 471 50 discriminator 2 view .LVU422
 1341 005a DBB2     		uxtb	r3, r3
 1342              	.LVL119:
 1343              	.L97:
 471:Lib/libcanard/drivers/stm32/canard_stm32.c ****     {
 1344              		.loc 1 471 5 discriminator 1 view .LVU423
 1345 005c 8B42     		cmp	r3, r1
 1346 005e 0ED2     		bcs	.L112
 1347              	.LBB20:
 516:Lib/libcanard/drivers/stm32/canard_stm32.c ****         uint32_t mask = 0;
 1348              		.loc 1 516 9 is_stmt 1 view .LVU424
ARM GAS  /tmp/ccGBICaP.s 			page 36


 1349              	.LVL120:
 517:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 1350              		.loc 1 517 9 view .LVU425
 519:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 1351              		.loc 1 519 9 view .LVU426
 519:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 1352              		.loc 1 519 63 is_stmt 0 view .LVU427
 1353 0060 06EBC305 		add	r5, r6, r3, lsl #3
 1354              	.LVL121:
 521:Lib/libcanard/drivers/stm32/canard_stm32.c ****         {
 1355              		.loc 1 521 9 is_stmt 1 view .LVU428
 521:Lib/libcanard/drivers/stm32/canard_stm32.c ****         {
 1356              		.loc 1 521 17 is_stmt 0 view .LVU429
 1357 0064 56F83340 		ldr	r4, [r6, r3, lsl #3]
 521:Lib/libcanard/drivers/stm32/canard_stm32.c ****         {
 1358              		.loc 1 521 12 view .LVU430
 1359 0068 002C     		cmp	r4, #0
 1360 006a D4DB     		blt	.L98
 521:Lib/libcanard/drivers/stm32/canard_stm32.c ****         {
 1361              		.loc 1 521 54 discriminator 1 view .LVU431
 1362 006c 6A68     		ldr	r2, [r5, #4]
 521:Lib/libcanard/drivers/stm32/canard_stm32.c ****         {
 1363              		.loc 1 521 46 discriminator 1 view .LVU432
 1364 006e 002A     		cmp	r2, #0
 1365 0070 D1DA     		bge	.L98
 529:Lib/libcanard/drivers/stm32/canard_stm32.c ****             mask = (cfg->mask & CANARD_CAN_STD_ID_MASK) << 21U;
 1366              		.loc 1 529 13 is_stmt 1 view .LVU433
 529:Lib/libcanard/drivers/stm32/canard_stm32.c ****             mask = (cfg->mask & CANARD_CAN_STD_ID_MASK) << 21U;
 1367              		.loc 1 529 18 is_stmt 0 view .LVU434
 1368 0072 6005     		lsls	r0, r4, #21
 1369              	.LVL122:
 530:Lib/libcanard/drivers/stm32/canard_stm32.c ****         }
 1370              		.loc 1 530 13 is_stmt 1 view .LVU435
 530:Lib/libcanard/drivers/stm32/canard_stm32.c ****         }
 1371              		.loc 1 530 18 is_stmt 0 view .LVU436
 1372 0074 5205     		lsls	r2, r2, #21
 1373              	.LVL123:
 530:Lib/libcanard/drivers/stm32/canard_stm32.c ****         }
 1374              		.loc 1 530 18 view .LVU437
 1375 0076 D3E7     		b	.L100
 1376              	.L111:
 540:Lib/libcanard/drivers/stm32/canard_stm32.c ****         }
 1377              		.loc 1 540 13 is_stmt 1 view .LVU438
 540:Lib/libcanard/drivers/stm32/canard_stm32.c ****         }
 1378              		.loc 1 540 18 is_stmt 0 view .LVU439
 1379 0078 42F00402 		orr	r2, r2, #4
 1380              	.LVL124:
 540:Lib/libcanard/drivers/stm32/canard_stm32.c ****         }
 1381              		.loc 1 540 18 view .LVU440
 1382 007c D8E7     		b	.L102
 1383              	.LVL125:
 1384              	.L112:
 540:Lib/libcanard/drivers/stm32/canard_stm32.c ****         }
 1385              		.loc 1 540 18 view .LVU441
 1386              	.LBE20:
 1387              	.LBE18:
 561:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
ARM GAS  /tmp/ccGBICaP.s 			page 37


 562:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 563:Lib/libcanard/drivers/stm32/canard_stm32.c ****     return 0;
 1388              		.loc 1 563 12 view .LVU442
 1389 007e 0020     		movs	r0, #0
 1390              	.LVL126:
 1391              	.L96:
 564:Lib/libcanard/drivers/stm32/canard_stm32.c **** }
 1392              		.loc 1 564 1 view .LVU443
 1393 0080 70BC     		pop	{r4, r5, r6}
 1394              	.LCFI15:
 1395              		.cfi_restore 6
 1396              		.cfi_restore 5
 1397              		.cfi_restore 4
 1398              		.cfi_def_cfa_offset 0
 1399              	.LVL127:
 1400              		.loc 1 564 1 view .LVU444
 1401 0082 7047     		bx	lr
 1402              	.LVL128:
 1403              	.L105:
 458:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 1404              		.loc 1 458 16 view .LVU445
 1405 0084 6FF00100 		mvn	r0, #1
 1406              	.LVL129:
 1407              		.loc 1 564 1 view .LVU446
 1408 0088 7047     		bx	lr
 1409              	.LVL130:
 1410              	.L106:
 1411              	.LCFI16:
 1412              		.cfi_def_cfa_offset 12
 1413              		.cfi_offset 4, -12
 1414              		.cfi_offset 5, -8
 1415              		.cfi_offset 6, -4
 458:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 1416              		.loc 1 458 16 view .LVU447
 1417 008a 6FF00100 		mvn	r0, #1
 1418              	.LVL131:
 458:Lib/libcanard/drivers/stm32/canard_stm32.c ****     }
 1419              		.loc 1 458 16 view .LVU448
 1420 008e F7E7     		b	.L96
 1421              	.L114:
 1422              		.align	2
 1423              	.L113:
 1424 0090 00640040 		.word	1073767424
 1425              		.cfi_endproc
 1426              	.LFE9:
 1428              		.section	.text.canardSTM32GetStats,"ax",%progbits
 1429              		.align	1
 1430              		.global	canardSTM32GetStats
 1431              		.syntax unified
 1432              		.thumb
 1433              		.thumb_func
 1434              		.fpu fpv4-sp-d16
 1436              	canardSTM32GetStats:
 1437              	.LVL132:
 1438              	.LFB10:
 565:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
 566:Lib/libcanard/drivers/stm32/canard_stm32.c **** 
ARM GAS  /tmp/ccGBICaP.s 			page 38


 567:Lib/libcanard/drivers/stm32/canard_stm32.c **** CanardSTM32Stats canardSTM32GetStats(void)
 568:Lib/libcanard/drivers/stm32/canard_stm32.c **** {
 1439              		.loc 1 568 1 is_stmt 1 view -0
 1440              		.cfi_startproc
 1441              		@ args = 0, pretend = 0, frame = 0
 1442              		@ frame_needed = 0, uses_anonymous_args = 0
 1443              		@ link register save eliminated.
 1444              		.loc 1 568 1 is_stmt 0 view .LVU450
 1445 0000 10B4     		push	{r4}
 1446              	.LCFI17:
 1447              		.cfi_def_cfa_offset 4
 1448              		.cfi_offset 4, -4
 1449 0002 0446     		mov	r4, r0
 569:Lib/libcanard/drivers/stm32/canard_stm32.c ****     return g_stats;
 1450              		.loc 1 569 5 is_stmt 1 view .LVU451
 1451              		.loc 1 569 12 is_stmt 0 view .LVU452
 1452 0004 034B     		ldr	r3, .L117
 1453 0006 0FCB     		ldm	r3, {r0, r1, r2, r3}
 1454              	.LVL133:
 1455              		.loc 1 569 12 view .LVU453
 1456 0008 84E80F00 		stm	r4, {r0, r1, r2, r3}
 570:Lib/libcanard/drivers/stm32/canard_stm32.c **** }
 1457              		.loc 1 570 1 view .LVU454
 1458 000c 2046     		mov	r0, r4
 1459 000e 5DF8044B 		ldr	r4, [sp], #4
 1460              	.LCFI18:
 1461              		.cfi_restore 4
 1462              		.cfi_def_cfa_offset 0
 1463              	.LVL134:
 1464              		.loc 1 570 1 view .LVU455
 1465 0012 7047     		bx	lr
 1466              	.L118:
 1467              		.align	2
 1468              	.L117:
 1469 0014 00000000 		.word	.LANCHOR0
 1470              		.cfi_endproc
 1471              	.LFE10:
 1473              		.section	.bss.g_abort_tx_on_error,"aw",%nobits
 1474              		.set	.LANCHOR1,. + 0
 1477              	g_abort_tx_on_error:
 1478 0000 00       		.space	1
 1479              		.section	.bss.g_stats,"aw",%nobits
 1480              		.align	3
 1481              		.set	.LANCHOR0,. + 0
 1484              	g_stats:
 1485 0000 00000000 		.space	16
 1485      00000000 
 1485      00000000 
 1485      00000000 
 1486              		.section	.rodata.RFxR.6637,"a"
 1487              		.align	2
 1488              		.set	.LANCHOR4,. + 0
 1491              	RFxR.6637:
 1492 0000 0C640040 		.word	1073767436
 1493 0004 10640040 		.word	1073767440
 1494              		.section	.rodata.__func__.6620,"a"
 1495              		.align	2
ARM GAS  /tmp/ccGBICaP.s 			page 39


 1496              		.set	.LANCHOR2,. + 0
 1499              	__func__.6620:
 1500 0000 63616E61 		.ascii	"canardSTM32Init\000"
 1500      72645354 
 1500      4D333249 
 1500      6E697400 
 1501              		.section	.rodata.__func__.6632,"a"
 1502              		.align	2
 1503              		.set	.LANCHOR3,. + 0
 1506              	__func__.6632:
 1507 0000 63616E61 		.ascii	"canardSTM32Transmit\000"
 1507      72645354 
 1507      4D333254 
 1507      72616E73 
 1507      6D697400 
 1508              		.section	.rodata.canardSTM32Init.str1.4,"aMS",%progbits,1
 1509              		.align	2
 1510              	.LC0:
 1511 0000 30203D3D 		.ascii	"0 == ((volatile CanardSTM32CANType*)0x40006400U)->I"
 1511      20282876 
 1511      6F6C6174 
 1511      696C6520 
 1511      43616E61 
 1512 0033 455200   		.ascii	"ER\000"
 1513 0036 0000     		.space	2
 1514              	.LC1:
 1515 0038 4C69622F 		.ascii	"Lib/libcanard/drivers/stm32/canard_stm32.c\000"
 1515      6C696263 
 1515      616E6172 
 1515      642F6472 
 1515      69766572 
 1516 0063 00       		.space	1
 1517              	.LC2:
 1518 0064 28282828 		.ascii	"((((volatile CanardSTM32CANType*)0x40006400U)->FMR "
 1518      766F6C61 
 1518      74696C65 
 1518      2043616E 
 1518      61726453 
 1519 0097 3E3E2038 		.ascii	">> 8U) & 0x3FU) == 14U\000"
 1519      55292026 
 1519      20307833 
 1519      46552920 
 1519      3D3D2031 
 1520              		.section	.rodata.canardSTM32Transmit.str1.4,"aMS",%progbits,1
 1521              		.align	2
 1522              	.LC3:
 1523 0000 21224341 		.ascii	"!\"CAN PRIO INV\"\000"
 1523      4E205052 
 1523      494F2049 
 1523      4E562200 
 1524              	.LC4:
 1525 0010 74785F6D 		.ascii	"tx_mailbox < 3\000"
 1525      61696C62 
 1525      6F78203C 
 1525      203300
 1526              		.text
 1527              	.Letext0:
ARM GAS  /tmp/ccGBICaP.s 			page 40


 1528              		.file 2 "/usr/arm-none-eabi/include/machine/_default_types.h"
 1529              		.file 3 "/usr/arm-none-eabi/include/sys/_stdint.h"
 1530              		.file 4 "/usr/arm-none-eabi/include/stdint.h"
 1531              		.file 5 "Lib/libcanard/canard.h"
 1532              		.file 6 "/usr/arm-none-eabi/include/sys/lock.h"
 1533              		.file 7 "/usr/arm-none-eabi/include/sys/_types.h"
 1534              		.file 8 "/usr/lib/gcc/arm-none-eabi/8.2.0/include/stddef.h"
 1535              		.file 9 "/usr/arm-none-eabi/include/sys/reent.h"
 1536              		.file 10 "Lib/libcanard/drivers/stm32/canard_stm32.h"
 1537              		.file 11 "Lib/libcanard/drivers/stm32/_internal_bxcan.h"
 1538              		.file 12 "/usr/arm-none-eabi/include/sys/unistd.h"
 1539              		.file 13 "/usr/arm-none-eabi/include/assert.h"
ARM GAS  /tmp/ccGBICaP.s 			page 41


DEFINED SYMBOLS
                            *ABS*:0000000000000000 canard_stm32.c
     /tmp/ccGBICaP.s:18     .text.isFramePriorityHigher:0000000000000000 $t
     /tmp/ccGBICaP.s:25     .text.isFramePriorityHigher:0000000000000000 isFramePriorityHigher
     /tmp/ccGBICaP.s:146    .text.convertFrameIDCanardToRegister:0000000000000000 $t
     /tmp/ccGBICaP.s:152    .text.convertFrameIDCanardToRegister:0000000000000000 convertFrameIDCanardToRegister
     /tmp/ccGBICaP.s:196    .text.convertFrameIDRegisterToCanard:0000000000000000 $t
     /tmp/ccGBICaP.s:202    .text.convertFrameIDRegisterToCanard:0000000000000000 convertFrameIDRegisterToCanard
     /tmp/ccGBICaP.s:249    .text.waitMSRINAKBitStateChange:0000000000000000 $t
     /tmp/ccGBICaP.s:255    .text.waitMSRINAKBitStateChange:0000000000000000 waitMSRINAKBitStateChange
     /tmp/ccGBICaP.s:326    .text.processErrorStatus:0000000000000000 $t
     /tmp/ccGBICaP.s:332    .text.processErrorStatus:0000000000000000 processErrorStatus
     /tmp/ccGBICaP.s:389    .text.processErrorStatus:0000000000000038 $d
     /tmp/ccGBICaP.s:397    .text.canardSTM32Init:0000000000000000 $t
     /tmp/ccGBICaP.s:404    .text.canardSTM32Init:0000000000000000 canardSTM32Init
     /tmp/ccGBICaP.s:753    .text.canardSTM32Init:00000000000001ac $d
     /tmp/ccGBICaP.s:765    .text.canardSTM32Transmit:0000000000000000 $t
     /tmp/ccGBICaP.s:772    .text.canardSTM32Transmit:0000000000000000 canardSTM32Transmit
     /tmp/ccGBICaP.s:1030   .text.canardSTM32Transmit:00000000000000fc $d
     /tmp/ccGBICaP.s:1040   .text.canardSTM32Receive:0000000000000000 $t
     /tmp/ccGBICaP.s:1047   .text.canardSTM32Receive:0000000000000000 canardSTM32Receive
     /tmp/ccGBICaP.s:1219   .text.canardSTM32Receive:000000000000008c $d
     /tmp/ccGBICaP.s:1226   .text.canardSTM32ConfigureAcceptanceFilters:0000000000000000 $t
     /tmp/ccGBICaP.s:1233   .text.canardSTM32ConfigureAcceptanceFilters:0000000000000000 canardSTM32ConfigureAcceptanceFilters
     /tmp/ccGBICaP.s:1424   .text.canardSTM32ConfigureAcceptanceFilters:0000000000000090 $d
     /tmp/ccGBICaP.s:1429   .text.canardSTM32GetStats:0000000000000000 $t
     /tmp/ccGBICaP.s:1436   .text.canardSTM32GetStats:0000000000000000 canardSTM32GetStats
     /tmp/ccGBICaP.s:1469   .text.canardSTM32GetStats:0000000000000014 $d
     /tmp/ccGBICaP.s:1477   .bss.g_abort_tx_on_error:0000000000000000 g_abort_tx_on_error
     /tmp/ccGBICaP.s:1478   .bss.g_abort_tx_on_error:0000000000000000 $d
     /tmp/ccGBICaP.s:1480   .bss.g_stats:0000000000000000 $d
     /tmp/ccGBICaP.s:1484   .bss.g_stats:0000000000000000 g_stats
     /tmp/ccGBICaP.s:1487   .rodata.RFxR.6637:0000000000000000 $d
     /tmp/ccGBICaP.s:1491   .rodata.RFxR.6637:0000000000000000 RFxR.6637
     /tmp/ccGBICaP.s:1495   .rodata.__func__.6620:0000000000000000 $d
     /tmp/ccGBICaP.s:1499   .rodata.__func__.6620:0000000000000000 __func__.6620
     /tmp/ccGBICaP.s:1502   .rodata.__func__.6632:0000000000000000 $d
     /tmp/ccGBICaP.s:1506   .rodata.__func__.6632:0000000000000000 __func__.6632
     /tmp/ccGBICaP.s:1509   .rodata.canardSTM32Init.str1.4:0000000000000000 $d
     /tmp/ccGBICaP.s:1521   .rodata.canardSTM32Transmit.str1.4:0000000000000000 $d

UNDEFINED SYMBOLS
__assert_func
